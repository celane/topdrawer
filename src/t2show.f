C        MORTRAN 2.79 (BRACKETED KEYWORD MACROS OF 09/28/81)          
      SUBROUTINE T2SHOW(INFOIN,CARDIN)
      IMPLICIT NONE
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER T2_SHOW1,I,IMAX
      INTEGER INFOIN(10)
      CHARACTER*(*) CARDIN
      DO 10011 IMAX=1,5
      I=T2_SHOW1(INFOIN,CARDIN)
      IF (LTRAP .or. I .eq. 0) GOTO 10020
      CALL T2_SHOW_ALL
10011 CONTINUE
10012 CONTINUE
10020 CONTINUE
      END
      INTEGER FUNCTION T2_SHOW1(INFOIN,CARDIN)
      INTEGER INFOIN(10)
      CHARACTER*(*) CARDIN
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      INTEGER N1,N2,N3,N4,NS1,NS2
      REAL TLIM(3,2)
      REAL HNONE
      INTEGER NSETD 
      PARAMETER (NSETD=19+9)
      INTEGER ISETD(NSETD),NINCR0,NINCR1,NINCR2,IBTYPE
      INTEGER I1,I2,I3,I4,I5,I6,I7,IM,NP,NL,IENDAT,IBGDAT
      INTEGER I_NDX,I_NDY,I_NDZ
      INTEGER N_SYMBOL 
      INTEGER N_XDATA 
      INTEGER N_DXDATA 
      INTEGER N_NDXDATA 
      INTEGER N_YDATA 
      INTEGER N_DYDATA 
      INTEGER N_NDYDATA 
      INTEGER N_ZDATA 
      INTEGER N_DZDATA 
      INTEGER N_NDZDATA 
      INTEGER N_UDATA 
      INTEGER N_DUDATA 
      INTEGER N_NDUDATA 
      INTEGER N_VDATA 
      INTEGER N_DVDATA 
      INTEGER N_NDVDATA 
      INTEGER N_WDATA 
      INTEGER N_DWDATA 
      INTEGER N_NDWDATA 
      INTEGER NCMAX 
      INTEGER NCSIZE 
      INTEGER NBTYPE 
      INTEGER NINDAT 
      INTEGER NSDATA 
      INTEGER NXDATA 
      INTEGER NDXDATA 
      INTEGER NNDXDATA 
      INTEGER NYDATA 
      INTEGER NDYDATA 
      INTEGER NNDYDATA 
      INTEGER NZDATA 
      INTEGER NDZDATA 
      INTEGER NNDZDATA 
      INTEGER NPDATA 
      INTEGER NLDATA 
      INTEGER NMDATA 
      INTEGER NBGDAT 
      INTEGER NENDAT 
      PARAMETER (N_SYMBOL=1) 
      PARAMETER (N_XDATA=2) 
      PARAMETER (N_DXDATA=3) 
      PARAMETER (N_NDXDATA=4) 
      PARAMETER (N_YDATA=5) 
      PARAMETER (N_DYDATA=6) 
      PARAMETER (N_NDYDATA=7) 
      PARAMETER (N_ZDATA=8) 
      PARAMETER (N_DZDATA=9) 
      PARAMETER (N_NDZDATA=10) 
      PARAMETER (N_UDATA=11) 
      PARAMETER (N_DUDATA=12) 
      PARAMETER (N_NDUDATA=13) 
      PARAMETER (N_VDATA=14) 
      PARAMETER (N_DVDATA=15) 
      PARAMETER (N_NDVDATA=16) 
      PARAMETER (N_WDATA=17) 
      PARAMETER (N_DWDATA=18) 
      PARAMETER (N_NDWDATA=19) 
      PARAMETER (NCMAX=6) 
      PARAMETER (NCSIZE=3) 
      PARAMETER (NBTYPE=1) 
      PARAMETER (NINDAT=2) 
      PARAMETER (NSDATA=5) 
      PARAMETER (NXDATA=NSDATA+1) 
      PARAMETER (NDXDATA=NXDATA+1) 
      PARAMETER (NNDXDATA=NXDATA+2) 
      PARAMETER (NYDATA=NXDATA+NCSIZE) 
      PARAMETER (NDYDATA=NYDATA+1) 
      PARAMETER (NNDYDATA=NYDATA+2) 
      PARAMETER (NZDATA=NYDATA+NCSIZE) 
      PARAMETER (NDZDATA=NZDATA+1) 
      PARAMETER (NNDZDATA=NZDATA+2) 
      PARAMETER (NPDATA=NSDATA+19) 
      PARAMETER (NLDATA=NPDATA+1) 
      PARAMETER (NMDATA=NLDATA+1) 
      PARAMETER (NBGDAT=NMDATA+1) 
      PARAMETER (NENDAT=NBGDAT+1) 
      EQUIVALENCE (IBTYPE,ISETD(NBTYPE))
      EQUIVALENCE (NINCR0,ISETD(NINDAT))
      EQUIVALENCE (NINCR1,ISETD(NINDAT+1))
      EQUIVALENCE (NINCR2,ISETD(NINDAT+2))
      EQUIVALENCE (I7,ISETD(NSDATA))
      EQUIVALENCE (I1,ISETD(NXDATA))
      EQUIVALENCE (I4,ISETD(NDXDATA))
      EQUIVALENCE (I2,ISETD(NYDATA))
      EQUIVALENCE (I5,ISETD(NDYDATA))
      EQUIVALENCE (I3,ISETD(NZDATA))
      EQUIVALENCE (I6,ISETD(NDZDATA))
      EQUIVALENCE (I_NDX,ISETD(NNDXDATA))
      EQUIVALENCE (I_NDY,ISETD(NNDYDATA))
      EQUIVALENCE (I_NDZ,ISETD(NNDZDATA))
      EQUIVALENCE (NP,ISETD(NPDATA))
      EQUIVALENCE (NL,ISETD(NLDATA))
      EQUIVALENCE (IM,ISETD(NMDATA))
      EQUIVALENCE (IBGDAT,ISETD(NBGDAT))
      EQUIVALENCE (IENDAT,ISETD(NENDAT))
      LOGICAL DFLAGS(200),DSCREV(3)
      COMMON /T2FLGD/DFLAGS,DSCREV
      REAL DTITLIN(4), DTITFAC(4), DTITMAR(4)
      INTEGER DGRDTYP, DGRDTEX, DOUTTEX, IDAXTEX, DTITEX, DSHADOWTYP,DS
     *HADOWTEX, IFLDDF(19), NDDIMNS, IDTXPRI, IDTXSEC, LINCLF, LINTXF,
     * LINWDF, DNONLN(3), DNXYZ1(3), DNXYZ2(3), DLABTEX, DTICTEX, DNPAT
     *RN(30), DLBLCHR(3), ND_CYCLE, IDTX_CYCLE(MAX_CYCLE)
      REAL DSYM_CYCLE(MAX_CYCLE)
      REAL DTITSIZ, DGRDSYM, DGRDSIZ, DCIRSIZ(2,3), DASIZE, DAFLARE, D
     *SMSZDF, DORAXES(3), DEYEDIR(3), DVUEDIR(3), DVUECEN(3), DVERTCL(3
     *), DEYESEP, DSCRD, DSCRZ, DEYEDIS, DEYEPNT(3), DBARSIZ(3), DBARBR
     *K(3), DTIKSIZ(3), DXYZBS(3), DTTHETA, DTPHI, DFRELBL(4), DPATRN(2
     *0,30), DSCLPRM(10,3), DWINDOW(4), DSCREEN(2), DSYMBOL, DNOSYMB, 
     *DAXANG(3), DLBLSIZ, DSYMSIZ, DXYZLIM(3,2), DFACTXY(19), DRADANG,
     * DDSCAL, DPATSZ, DTITINX, DTIKFAC, DSYDIR(3), DGRDIR(3)
      COMMON /T2COMD/ DTITSIZ, DGRDSYM, DGRDSIZ, DCIRSIZ, DASIZE, DAFLA
     *RE, DSMSZDF, DORAXES, DEYEDIR, DVUEDIR, DVUECEN, DVERTCL, DEYESE
     *P, DSCRD, DSCRZ, DEYEDIS, DEYEPNT, DBARSIZ, DTIKSIZ, DXYZBS, DTTH
     *ETA, DTPHI, DFRELBL, DNPATRN, DPATRN, DSCLPRM, DWINDOW, DSCREEN,
     * DSYMBOL, DNOSYMB, DAXANG, DLBLSIZ, DSYMSIZ, DXYZLIM, DGRDTYP, D
     *FACTXY, IFLDDF, NDDIMNS, DGRDTEX, DOUTTEX, IDAXTEX, DTITEX, DRADA
     *NG, DDSCAL, DNONLN, DNXYZ1, DNXYZ2, LINCLF, LINTXF, LINWDF, DLABT
     *EX, DTICTEX, DPATSZ, IDTXPRI, IDTXSEC, DTITLIN, DTITINX, DLBLCHR,
     * DTITFAC, DTITMAR, DTIKFAC, DSYDIR, DGRDIR, ND_CYCLE, IDTX_CYCLE,
     * DSYM_CYCLE, DBARBRK,  DSHADOWTYP,DSHADOWTEX
      REAL PLIM(4,4),ZSCRN(2),XLLINE,YLLINE,XTLINE,YTLINE,XFRMFC, PAT(2
     *0),PATCUM,PATTOT,PATMOD,CCSCIS(4),DISPL, RESOL(2)
      INTEGER NPTS,IDDEVC,IPAT,NPAT,LMOVE,IROTAX,IROTAF
      COMMON/TXCOM/PLIM,ZSCRN, XLLINE,YLLINE,XTLINE,YTLINE,XFRMFC, IPA
     *T,NPAT,PAT,PATTOT, NPTS,IDDEVC,CCSCIS,LMOVE,IROTAX,DISPL,IROTAF,P
     *ATCUM,PATMOD, RESOL
      INTEGER LISTPT,NPTMAX,NDSETS
      REAL DATBUF(10248)
      COMMON /T2XPNT/ LISTPT,NPTMAX,NDSETS,DATBUF
      INTEGER T2BTRIM
      CHARACTER*4 T2_GET_SYMBOL
      REAL PI 
      PARAMETER (PI=6.2831853)
      REAL TEMPA(10)
      REAL TEMP,TEMP1,TEMP2,TEMP3,TEMP4,T
      EQUIVALENCE (TEMP1,TEMPA(1))
      EQUIVALENCE (TEMP2,TEMPA(2))
      EQUIVALENCE (TEMP3,TEMPA(3))
      EQUIVALENCE (TEMP4,TEMPA(4))
      REAL XFAC,YFAC,ZFAC
      LOGICAL LSET,LTEMP,LTEMP1,LTEMP2,LTEMP3
      LOGICAL LDATA,LSTAT,LTOTAL,LHEADER,L_OPENED
      REAL TARR(8) ,DLIM(3,2)
      EQUIVALENCE (DLIM(1,1),XMIN),(DLIM(1,2),XMAX)
      EQUIVALENCE (DLIM(2,1),YMIN),(DLIM(2,2),YMAX)
      EQUIVALENCE (DLIM(3,1),ZMIN),(DLIM(3,2),ZMAX)
      DOUBLE PRECISION DSUM(8),DERR(8,4),DTOTAL(8),DTERR(8,4)
      REAL SUM(8)
      REAL XYZ(19),XYZ1(2),XYZ2(3),XYZ0(2),XYSHLD(2,2),XYDEV(2,2)
      CHARACTER DIGITS*10
      CHARACTER*3 C_STATUS
      CHARACTER*10 C_ACCESS
      CHARACTER*6 CJUST(3)
      CHARACTER*6 CSHORT(2)
      CHARACTER*11 CTEMP,CTEMP1
      CHARACTER*4 SYM,SYM1
      CHARACTER*5 CWID(3)
      CHARACTER*3 CXYZ(4)
      CHARACTER*4 ONOFF(3)
      CHARACTER*5 CASE(3)
      INTEGER MAXGRDTYP 
      PARAMETER (MAXGRDTYP=9)
      CHARACTER*12 CGRTYP(MAXGRDTYP)
      CHARACTER*8 COL(8)
      CHARACTER*8 CFONT(3)
      CHARACTER*1 DCASE
      CHARACTER*7 CORDER(0:19)
      CHARACTER*8 CSCALE(10)
      CHARACTER*10 CTEX(8)
      CHARACTER*7 CLIMIT(3,2)
      CHARACTER*8 CBOX(3)
      CHARACTER*10 CERR(5)
      CHARACTER*8 CSET(2)
      CHARACTER*20 CUNIT1,CUNIT2
      CHARACTER*20 CUNIT(2),T2_GET_UNIT_NAME
      EQUIVALENCE (CUNIT1,CUNIT),(CUNIT2,CUNIT(2))
      REAL CUNITN(2)
      INTEGER NUNIT1,NUNIT2
      INTEGER I,J,K,L,M,N,IWIDE,IHIGH,IW,NW
      INTEGER ITEMP(15)
      INTEGER IOSTAT
      CHARACTER*4 QUOTES
      CHARACTER*8 CPAT(10)
      CHARACTER*10 CSEGM(8)
      REAL INCHES , CM 
      CHARACTER*6 CUNIT3
      PARAMETER (INCHES = 1.0)
      PARAMETER (CM = 2.54)
      PARAMETER (CUNIT3 = 'inches')
      REAL MM, DM, METERS, MILS, POINTS, FEET, YARDS 
      REAL FATHOMS, RODS, FURLONGS, MILES, LEAGUES 
      INTEGER MAXUNITS
      PARAMETER ( MM = CM*10)
      PARAMETER ( DM = CM/10)
      PARAMETER ( METERS = CM/100)
      PARAMETER ( MILS = INCHES*1000)
      PARAMETER ( POINTS = INCHES*72)
      PARAMETER ( FEET = INCHES/12)
      PARAMETER ( YARDS = FEET/3)
      PARAMETER ( FATHOMS = FEET/6)
      PARAMETER ( RODS = FEET/16.5)
      PARAMETER ( FURLONGS = RODS/40)
      PARAMETER ( MILES = FURLONGS/8)
      PARAMETER ( LEAGUES = MILES/3)
      PARAMETER ( MAXUNITS = 14)
      CHARACTER TKSTR*558
      REAL UNITS(MAXUNITS)
      CHARACTER*10 C_UNITS(MAXUNITS)
      DATA HNONE /-666.666/
      DATA DIGITS/'0123456789'/
      DATA CJUST/'Left','Center','Right'/
      DATA CSHORT/' short',' long'/
      DATA CWID/'  Dx=','  Dy=','  Dz='/
      DATA CXYZ/'X','Y','Z',' '/
      DATA ONOFF/'ON','OFF','AUTO'/
      DATA CASE/'Upper','Lower','Mixed'/
      DATA CGRTYP/'  Vert.','  Horiz.','  Z','  Char.', 
     *'  YZ','  ZY','  XY','  Outline', '  Cycle'/
      DATA COL/'WHITE','RED','GREEN','BLUE','YELLOW','MAGENTA','CYAN',
     *         'BLACK'/
      DATA CFONT/'BASIC','EXTENDED','DUPLEX'/
      DATA CORDER /' NONE',19*' NONE'/
      DATA CSCALE/'LINEAR','LOG','-LOG','MONTHS','YEARS','NORMAL', 
     *'SECONDS','MINUTES','HOURS','DAYS'/
      DATA CTEX/'DOTS','DASHES','DOTDASHES', 'SOLID','FUNNY',
     *'PATTERNED','DAASHES',' '/
      DATA CLIMIT/'  Xmin=','  Ymin=','  Zmin=','  Xmax=',
     *'  Ymax=','  Zmax='/
      DATA CBOX/'Box','Diamond','Ellipse'/
      DATA CERR/' Deferred',' Immediate',' List',' Nowait',' Wait'/
      DATA CSET/'Auto Set','User Set'/
      DATA CUNITN/2*0.0/
      DATA QUOTES/'"  "'/
      DATA CPAT/'Current','Axes','Tics','Grid','Outline','Shadow',4*' '/
      DATA CSEGM/'  Plots','  Axes','  Labels','  Ticks', 
     *' Outline'  ,'  Points','  Titles',' '/
      DATA UNITS/INCHES,MM,CM,METERS,POINTS,MILS,DM, FEET,YARDS,
     *FATHOMS,RODS,FURLONGS,MILES,LEAGUES/
      DATA C_UNITS/'inches','mm','cm','meters','points',
     *'mils','dm', 'feet','yards','fathoms','rods','furlongs',
     *'miles','leagues'/
      IWIDE=80
      IHIGH=24
      CALL T2GDSET(1,1, 2 147 483 647  ,1, 2 147 483 647,ISETD,HNONE,'*'
     *)
      T2_SHOW1=0
      IF (.not. FLAGS(74)) THEN
      CALL TXDEFW
      FLAGS(74)= .false.
      ENDIF
      DO 10031 I=1,2
      TEMP=REDUCE(I+1)
      IF (CUNITN(i) .ne. TEMP) THEN
      CUNITN(I)=ABS(TEMP)
      IF (I .eq. 2) TEMP=TEMP*10
      CUNIT(I)=T2_GET_UNIT_NAME(TEMP)
      ENDIF
10031 CONTINUE
10032 CONTINUE
      NUNIT1=T2BTRIM(CUNIT1)
      NUNIT2=T2BTRIM(CUNIT2)
      IOFF=0
      IF (FLAGS(27)) IOFF=9
      DO 10041 I=1,19
      CALL T2GVNM(I,CORDER(I))
10041 CONTINUE
10042 CONTINUE
10051 CONTINUE
      IF (LTRAP) GOTO 10020
      GOTO 10061
10090 CONTINUE
      T2_SHOW1 = 1
      RETURN
10110 CONTINUE
      TEMP1=MAX(1,INT(ABS(XYPART(1,1))))+  INT(ABS(XYPART(2,1))-1)*INT(A
     *BS(XYPART(1,2)))
      TEMP2=MAX(1,INT(ABS(XYPART(1,2))))*MAX(1,INT(ABS(XYPART(2,2))))
      WRITE(6,10120) 'Windows -',TEMP1,'of',TEMP2, 'Level=',IWINLEV
      DO 10131 I=1,2
      WRITE(6,10140) '  -->'//CXYZ(I),WINDOW(I)  ,'to',WINDOW(I+2),CUNIT
     *1(:NUNIT1)
      IF (XYPART(I,2).ne.0) WRITE(6,10140)' ', XYPART(I,1),'of',XYPART(I
     *,2)
      IF (IWINLEV.gt.1) WRITE(6,10140)'  Inside', WINLIM(I,1),'to',WINLI
     *M(I,2)+WINLIM(I,1),CUNIT1(:NUNIT1)
10131 CONTINUE
10132 CONTINUE
      GOTO 10062
10150 CONTINUE
      WRITE(6,10160)'Arrow -'
      WRITE(6,10170)'  Size='  ,ASIZE*REDUCE(3), DASIZE*REDUCE(3)  ,CUNI
     *T2(:NUNIT2)
      WRITE(6,10170)'  Flare=',AFLARE,DAFLARE,'fraction'
      GOTO 10062
10180 CONTINUE
      WRITE(6,10160)'Axes -'
      CALL T2_SHOW_ON_OFF('  Three=',134)
      CALL T2_SHOW_ON_OFF('  Front=',132)
      CALL T2_SHOW_ON_OFF('  Botht=',133)
      CALL T2_SHOW_AXIS(19,50)
      CALL T2_SHOW_INHIBIT(3)
      CALL T2_SHOW_TEXTURE(IAXTEX,IDAXTEX)
      GOTO 10062
10190 CONTINUE
      WRITE(6,10160)'Bar -'
      DO 10201 I=1,3
      WRITE(6,10170)  '  '//CXYZ(I)//'Size=',BARSIZ(I),DBARSIZ(I),CUNIT1
     *(:NUNIT1)//  '(-=fraction)'
      k=1
      IF( FLAGS(78+I) )K=2
      J=1
      IF( DFLAGS(78+I) )J=2
      WRITE(6,10210)' ',CSET(K),CSET(J)
      WRITE(6,10170)  '     ' //'Break=',BARBRK(I),DBARBRK(I)
      CALL T2_SHOW_ON_OFF('     Suppress',131)
10201 CONTINUE
10202 CONTINUE
      GOTO 10062
10220 CONTINUE
      I = INTEG
      WRITE(6,10230)CBOX(I),'- Size'
      DO 10241 J=1,2
      WRITE(6,10170)  CWID(J),CIRSIZ(J,I),DCIRSIZ(J,I),CUNIT1(:NUNIT1)
10241 CONTINUE
10242 CONTINUE
      GOTO 10062
10250 CONTINUE
      WRITE(6,10230)'Blink -',ONOFF(2-IBLINK)
      GOTO 10062
10260 CONTINUE
      WRITE(6,10270)'Card Length =', LENCRD
      GOTO 10062
10280 CONTINUE
      CALL T2_SHOW_CHARACTERS(INFOIN,CARDIN)
      GOTO 10062
10290 CONTINUE
      WRITE(6,10210)'Color =',COL(LINCOL),COL(LINCLF)
      GOTO 10062
10300 CONTINUE
      CALL T2_SHOW_ON_OFF('CTRL_Z -',-100)
      GOTO 10062
10310 CONTINUE
      CALL SYSTEM('env | grep TD_C_')
      GOTO 10062
10320 CONTINUE
      I = 0
      CALL T2CURS(I,XYZ0,XYZ1,XYZ2,LTEMP1,LTEMP2)
      IF (I .gt. 0) WRITE(STJOU,*)' (Dev:  X=',XYZ0(1)*REDUCE(2), ' Y=',
     *XYZ0(2)*REDUCE(2),' ',CUNIT1(:NUNIT1)//'   Key= "',CHAR(I),'"=',
     *I,')'
      DO 10331 J=1,80
      IF (STJOU(J:J).ne.' ') NSTJOU=J
10331 CONTINUE
10332 CONTINUE
      WRITE(6,*)STJOU(1:NSTJOU)
      CALL T2JOUR
      IF (LTEMP1) WRITE(STJOU,*)' (Text: X=',XYZ1(1),' Y=',XYZ1(2),' ',
     *CUNIT1(:NUNIT1),')'
      DO 10341 J=1,80
      IF (STJOU(J:J).ne.' ') NSTJOU=J
10341 CONTINUE
10342 CONTINUE
      WRITE(6,*)STJOU(1:NSTJOU)
      CALL T2JOUR
      IF (LTEMP2) IMAX=2
      IF (FLAGS(56)) IMAX=3
      WRITE(STJOU,*) ' (Data:',
     *(CORDER(I_VORDER(2*I,1))(:t2btrim(corder(i_vorder(2*I,1)))),
     *'=',XYZ2(I),I=1,IMAX),')'
      DO 10351 J=1,80
      IF (STJOU(J:J).ne.' ') NSTJOU=J
10351 CONTINUE
10352 CONTINUE
      WRITE(6,*)STJOU(1:NSTJOU)
      CALL T2JOUR
      GOTO 10062
10360 CONTINUE
      WRITE(6,10160)'Cycle -'
      DO 10371 I=1,N_CYCLE
      IF (LTRAP) GOTO 10020
      WRITE(6,'(3x,A,I10)')'Entry',I
      CALL T2_SHOW_TEXTURE(ITX_CYCLE(I),IDTX_CYCLE(I))
      SYM=T2_GET_SYMBOL(SYM_CYCLE(I))
      SYM1=T2_GET_SYMBOL(DSYM_CYCLE(I))
      WRITE(6,10210)'  Symbol=',SYM,SYM1
10371 CONTINUE
10372 CONTINUE
      GOTO 10062
10380 CONTINUE
      NS1=1
      NS2=NDSETS
      N_SELECT=1
      C_SELECT(1:1)='*'
      N1=1
      N2= 2 147 483 647
      N3=1
      N4= 2 147 483 647
      TLIM(1,1)=HNONE
      LDATA=.true.
      LSTAT=.true.
      LTOTAL=.true.
      ITOTAL=0
      LTEMP2=.false.
      LTEMP3=.TRUE.
      IFILE=6
      C_STATUS='NEW'
      C_ACCESS='SEQUENTIAL'
      N_FILE=0
      GOTO 10391
10420 CONTINUE
      IF (LTOKEN) THEN
      C_STATUS='OLD'
      C_ACCESS='APPEND'
      ELSE
      C_STATUS='NEW'
      C_ACCESS='SEQUENTIAL'
      ENDIF
      GOTO 10391
10430 CONTINUE
      CALL T2NSET(INFOIN,CARDIN,NS1,NS2)
      GOTO 10391
10440 CONTINUE
      CALL T2PNTS(INFOIN,CARDIN,N1,N2)
      GOTO 10391
10450 CONTINUE
      CALL T2ROWS(INFOIN,CARDIN,N3,N4)
      GOTO 10391
10460 CONTINUE
      C_FILE=STRNG
      N_FILE=NSTRNG
      CALL T2_SET_DEFAULT_FILE(C_FILE,N_FILE,'tdata.lis')
      IFILE=1
      IF (STRNG(1:NSTRNG).eq.'NONE') THEN
      IFILE=0
      ELSE
      IFILE=1
      ENDIF
      GOTO 10391
10470 CONTINUE
      LDATA=LTOKEN
      LSTAT=LTOKEN
      LTOTAL=LTOKEN
      GOTO 10391
10480 CONTINUE
      C_SELECT=STRNG
      N_SELECT=MAX(1,NSTRNG)
      GOTO 10391
10490 CONTINUE
      LDATA=.not.LTOKEN
      LSTAT=LTOKEN
      LTOTAL=LTOKEN
      GOTO 10391
10500 CONTINUE
      LDATA=.not.LTOKEN
      LSTAT=.not.LTOKEN
      LTOTAL=LTOKEN
      GOTO 10391
10510 CONTINUE
      LTEMP2=.true.
      CALL T2XYZC(INFOIN,CARDIN,TLIM,2,NLIM)
      GOTO 10391
10520 CONTINUE
      LTEMP3=LTOKEN
      GOTO 10391
10400 GOTO ( 10420,10430,10440,10440,10450,10450,10460,10460,10470,10470
     *,10470,10480,10490,10500,10510,10520,10395),KEYORD
10395 CONTINUE
      INFOIN(9)=-1
      GOTO 10392
10391 CALL TOKEN(INFOIN,CARDIN,'APPEND:Y,SETS,POINTS,COLUMNS,LINES,ROWS,
     *FILE:F,OUTPUT:F,BRIEF:N,ALL:Y,FULL:Y,SELECT:S,STATISTICS:Y,TOTAL:Y
     *,LIMITED,WEIGHTED:Y,;')
      GOTO (10392,10400,10395,10395,10395,10395,10395,10400,10395),INTER
     *P
10392 CONTINUE
      IF (N_FILE .gt. 0) THEN
      OPEN(UNIT=1  ,FILE=C_FILE(1:N_FILE)  ,STATUS=C_STATUS ,ACCESS=C_AC
     *CESS    ,IOSTAT=IOSTAT ,ERR=10530)
10530 CONTINUE
      IF (IOSTAT.ne.0) CALL T2_TYPE_ERROR(INFOIN,CARDIN,C_FILE(:N_FILE),
     *IOSTAT)
      ENDIF
      SETNUM=0
      LTEMP1=LSTAT.or.LTOTAL
      LHEADER=(LDATA .or. LSTAT .or. .not. LTOTAL) .and. IFILE .gt. 0
      IF (IFILE.eq.0) THEN
      LDATA=.false.
      LSTAT=.false.
      LTOTAL=.false.
      ENDIF
      IF (.not.(FLAGS(23).and.FLAGS(92))) THEN
      IF (LTEMP1) THEN
      DO 10541 J=1,8
      DO 10551 I=1,2
      DATDAT(I,J)=0
10551 CONTINUE
10552 CONTINUE
10541 CONTINUE
10542 CONTINUE
      DO 10561 J=1,8
      DTOTAL(J)=0.0
10561 CONTINUE
10562 CONTINUE
      DO 10571 J=1,4
      DO 10581 K=1,8
      DTERR(K,J)=0.0
10581 CONTINUE
10582 CONTINUE
10571 CONTINUE
10572 CONTINUE
      CALL T2DTLM(TLIM,N1,N2,N3,N4,NS1,NS2,XFAC,YFAC,ZFAC,DLIM, 2,C_SELE
     *CT(:N_SELECT))
      DATXMN=XMIN
      DATXMX=XMAX
      DATYMN=YMIN
      DATYMX=YMAX
      DATZMN=ZMIN
      DATZMX=ZMAX
      ENDIF
      IDIGIT=6
      IF (IDIGIT.eq.0) IDIGIT=3
      IW=IDIGIT+7
      IF (IFILE.gt.0.and.NPOINT.gt.0) THEN
      WRITE(IFILE,*)' Data - ',NPOINT,' points ',NDSETS,' sets'
      ENDIF
      DO 10591 ISET=NS1,NS2
      CALL T2GDSET(ISET,N1,N2,N3,N4,ISETD,TLIM ,C_SELECT(:N_SELECT))
      IF(NL .lt. N3)GOTO 10591
      IF(NP .lt. N1)GOTO 10591
      JLIM=2
      IDEP=N_YDATA
      IF (DATBUF(I3).ne.HNONE) THEN
      JLIM=3
      IF (FLAGS(56).or.IBTYPE.eq.2) THEN
      IDEP=N_ZDATA
      YFAC=ZFAC
      ENDIF
      ENDIF
      IF (LTEMP1) THEN
      DO 10601 I=1,3
      DLIM(I,1)=1.0E35
      DLIM(I,2)=-1.0E35
10601 CONTINUE
10602 CONTINUE
      DO 10611 I=1,19
      XYZ(I)=0
10611 CONTINUE
10612 CONTINUE
      DO 10621 J=1,8
      DSUM(J)=0.0
10621 CONTINUE
10622 CONTINUE
      DO 10631 J=1,4
      DO 10641 K=1,8
      DERR(K,J)=0.0
10641 CONTINUE
10642 CONTINUE
10631 CONTINUE
10632 CONTINUE
      ENDIF
      IF (LHEADER) THEN
      WRITE(IFILE,*)' Data set=',ISET
      CALL T2_GET_SET_NAME(IBGDAT,OUTSTR)
      I=T2BTRIM(OUTSTR)
      IF (OUTSTR(:I) .ne. ' ') THEN
      WRITE(IFILE,*)'   Name=','"'//OUTSTR(:I)//'"'
      ENDIF
      ENDIF
      IF (IBTYPE.eq.2) THEN
      NW=(IWIDE-3-IW*NMESH0)/IW
      NW=(NW/NMESH0)*NMESH0
      IF (LHEADER) WRITE(IFILE,*)' Data - ',CXYZ(MESH3), 'Row ',CXYZ(MES
     *H2),NMESH2-1, ' by Cols ',CXYZ(MESH1),NMESH1-1
      NP=NMESH0*(NP-N1+1)-1
      IF (LDATA) THEN
      OUTSTR=' '
      OUTSTR(2:2)=CXYZ(MESH2)
      OUTSTR(IW*NMESH0-2:)=CXYZ(MESH1)
      IF (NMESH0.eq.2) THEN
      OUTSTR(IW+2:IW+3)='D'//CXYZ(MESH2)
      OUTSTR(IW*NMESH0-5:)=CXYZ(MESH1)(1:1)//  ',D'//CXYZ(MESH1)
      ENDIF
      IF (LDATA) WRITE(IFILE, '(2x,1p,A11,A2,A1,                        
     *                                      (T17,''|'',4G14.6))') CXYZ(M
     *ESH2),CXYZ(MESH1),'=', (DATBUF(I1+I),I=0,NP)
      ENDIF
      DO 10651 J=0,NP
      TEMP=DATBUF(I1+J)
      DLIM(MESH1,1)=MIN(TEMP,DLIM(MESH1,1))
      DLIM(MESH1,2)=MAX(TEMP,DLIM(MESH1,2))
10651 CONTINUE
10652 CONTINUE
      DO 10661 I=N3,NL
      IF (LTRAP) GOTO 10020
      TEMP=DATBUF(I2)
      XYZ(MESH2*2)=TEMP
      DLIM(MESH2,1)=MIN(TEMP,DLIM(MESH2,1))
      DLIM(MESH2,2)=MAX(TEMP,DLIM(MESH2,2))
      IF (NMESH0.eq.2) XYZ(MESH2*2+1)=DATBUF(I2+1)
      IF (LDATA) THEN
      WRITE(IFILE, '(2x,1p,G14.6,                                       
     *                           (''|'',4G14.6))')  (DATBUF(I2+K),K=0,NM
     *ESH0-1)  ,(DATBUF(I3+J),J=0,NP)
      ENDIF
      IF (LTEMP1 .and. .not. LSYERR) THEN
      DO 10671 J=0,NP,NMESH0
      IF (LTRAP) GOTO 10020
      XYZ(MESH1*2)=DATBUF(I1+J)
      TEMP=DATBUF(I3+J)
      XYZ(MESH3*2)=TEMP
      IF (.NOT.LTEMP2.or. (TEMP.ge.TLIM(MESH3,1).and. TEMP.le.TLIM(MESH3
     *,2))) THEN
      IF (NMESH0.eq.2) THEN
      XYZ(MESH1*2+1)=DATBUF(I1+J+1)
      XYZ(MESH3*2+1)=DATBUF(I3+J+1)
      ENDIF
      CALL T2DTSM(XYZ(2),XYZ(6), XYZ(3),XYZ(7), DSUM,DERR,LTEMP3)
      IF (TEMP.LT.DLIM(MESH3,1)) DLIM(MESH3,1)=TEMP
      IF (TEMP.GT.DLIM(MESH3,2)) DLIM(MESH3,2)=TEMP
      ENDIF
10671 CONTINUE
10672 CONTINUE
      ENDIF
      I2=I2+NINCR1*NINCR0
      I3=I3+NINCR1*NINCR0
10661 CONTINUE
10662 CONTINUE
      ELSEIF (IBTYPE.eq.1) THEN
      IF (LHEADER) WRITE(IFILE,'(7X,A,I7)') 'Points=',(IENDAT+1-IVRPTR(8
     *))/NINCR1
      DO 10681 I=1,19
      XYZ(I)=0
10681 CONTINUE
10682 CONTINUE
      K=NINCR1-1
      IF (ISIGFG.le.0) IDIGIT=MIN(MAX((IWIDE-20)/K-8,2),6)
      IW=IDIGIT+7
      IW=IW+MIN(MAX((IWIDE-20-IW*K)/K,0),1)
      IMAX=MIN(MAX((IWIDE-14)/IW,4),20)
      IF (LDATA) WRITE(IFILE, '(7x,A7,A10,(50 A14))') (CORDER(IVARBL(I))
     *,I=1,NINCR1)
      DO 10701 I=N1,NP
      IF (LTRAP) GOTO 10020
      DO 10711 J=1,NINCR1
      XYZ(IVARBL(J))=DATBUF(IM)
      IM=IM+1
10711 CONTINUE
10712 CONTINUE
      IF (LTEMP2) THEN
      DO 10721 J=1,JLIM
      IF ( XYZ(NCSIZE*(J-1)+N_XDATA).lt.TLIM(J,1) .or. XYZ(NCSIZE*(J-1)+
     *N_XDATA).gt.TLIM(J,2)) GOTO 10730
10721 CONTINUE
10722 CONTINUE
      ENDIF
      SYM=T2_GET_SYMBOL(XYZ(N_SYMBOL))
      IP=(IM-IVRPTR(8))/NINCR1
      IF (LDATA) THEN
      WRITE(IFILE, '(I7,1x,A4,2x,1p,(4 G14.6))')  IP,SYM,(XYZ(IVARBL(J))
     *,J=2,NINCR1)
      ENDIF
      IF (LTEMP1.and..not. LSYERR) THEN
      DO 10751 J=1,JLIM
      DLIM(J,1)=MIN(DLIM(J,1),XYZ(NCSIZE*(J-1)+N_XDATA))
      DLIM(J,2)=MAX(DLIM(J,2),XYZ(NCSIZE*(J-1)+N_XDATA))
10751 CONTINUE
10752 CONTINUE
      CALL T2DTSM(XYZ(N_XDATA),XYZ(IDEP), XYZ(N_DXDATA),XYZ(IDEP+1), DSU
     *M,DERR,LTEMP3)
      ENDIF
10730 CONTINUE
10701 CONTINUE
10702 CONTINUE
      ENDIF
      IF (LSYERR) THEN
      DTOTAL(8)=0
      LTOTAL=.false.
      CALL T2ERR(0,' ','* Statistics suppressed due to error',3)
      ELSEIF (DSUM(8).gt.0) THEN
      IF (LTEMP1) CALL T2STSM(XFAC,YFAC,DSUM,DERR,LTEMP3)
      IF (LSTAT) THEN
      WRITE(IFILE, '(4x,1p,5(A,1p,G15.6))')  'Pts= ',DATPTS
      WRITE(IFILE, '(4x,A,1p,5(A,1p,G15.6))')  CORDER(N_XDATA),' Min= ',
     *XMIN,' Max= ',XMAX
      WRITE(IFILE, '(4x,A,1p,5(A,1p,G15.6))')  CORDER(N_YDATA),' Min= ',
     *YMIN,' Max= ',YMAX
      IF (ZMIN.le.ZMAX) WRITE(IFILE, '(4x,A,1p,5(A,1p,G15.6))') CORDER(N
     *_ZDATA),' Min= ',ZMIN,' Max= ',ZMAX
      WRITE(IFILE, '(4x,A,1p,5(A,1p,G15.6))')  CORDER(IDEP), ' Sum= ',DA
     *TSUM,' Ave= ',DATAVE,'/Point'
      IF (ERRSUM.gt.0) WRITE(IFILE, '(11x,1p,5(A,1p,G15.6))') ' Err= ',E
     *RRSUM,' Err= ',ERRAVE
      IF (DATSUM.ne.0) WRITE(IFILE, '(4x,A,1p,5(A,1p,G15.6))') CORDER(N_
     *XDATA),' Mean=',DATCEN,' Std= ',DATSTD
      IF (ERRCEN.gt.0) WRITE(IFILE, '(11x,1p,5(A,1p,G15.6))') ' Err= ',E
     *RRCEN,' Err= ',ERRSTD
      ENDIF
      ITOTAL=ITOTAL+1
      DO 10761 J=1,8
      DTOTAL(J)=DTOTAL(J)+DSUM(J)
10761 CONTINUE
10762 CONTINUE
      DO 10771 J=1,4
      DO 10781 K=1,8
      DTERR(K,J)=DTERR(K,J)+DERR(K,J)
10781 CONTINUE
10782 CONTINUE
10771 CONTINUE
10772 CONTINUE
      ENDIF
10591 CONTINUE
10592 CONTINUE
      LTOTAL=LTOTAL .and. ITOTAL.gt.1
      IF (LTEMP1) CALL T2STSM(XFAC,YFAC,DTOTAL,DTERR,LTEMP3)
10790 CONTINUE
      IF (LTOTAL .and. IFILE.gt.0) THEN
      IF (DATPTS.gt.0) THEN
      IF (IBTYPE.eq.2 .or. (DATBUF(I3).ne.HNONE.and.FLAGS(56))) THEN
      IDEP=N_ZDATA
      ELSE
      IDEP=N_YDATA
      ENDIF
      WRITE(IFILE, '(4x,1p,5(A,1p,G15.6))')  'Total Pts= ',DATPTS
      WRITE(IFILE, '(4x,A,1p,5(A,1p,G15.6))')  CORDER(N_XDATA),' Min= ',
     *DATXMN,' Max= ',DATXMX
      WRITE(IFILE, '(4x,A,1p,5(A,1p,G15.6))')  CORDER(N_YDATA),' Min= ',
     *DATYMN,' Max= ',DATYMX
      IF (DATZMN.le.DATZMX) WRITE(IFILE, '(4x,A,1p,5(A,1p,G15.6))') CORD
     *ER(N_ZDATA),' Min= ',DATZMN,' Max= ',DATZMX
      WRITE(IFILE, '(4x,A,1p,5(A,1p,G15.6))') CORDER(IDEP), ' Sum= ',DAT
     *SUM,' Ave= ',DATAVE,'/Point'
      IF (ERRSUM.gt.0) WRITE(IFILE, '(11x,1p,5(A,1p,G15.6))') ' Err= ',E
     *RRSUM,' Err= ',ERRAVE
      IF (DATSUM.ne.0) THEN
      WRITE(IFILE, '(4x,A,1p,5(A,1p,G15.6))')  CORDER(N_XDATA),' Mean=',
     *DATCEN,' Std= ',DATSTD
      IF (ERRCEN.gt.0) WRITE(IFILE, '(11x,1p,5(A,1p,G15.6))') ' Err= ',E
     *RRCEN,' Err= ',ERRSTD
      ENDIF
      ELSE
      WRITE(6,10160)'Data - none available'
      ENDIF
      ENDIF
      ENDIF
      GOTO 10062
10800 CONTINUE
      WRITE(6,10810)'Date - Year=',IYEAR, 'Month=',IMONTH,'Day=',IDAY
      GOTO 10062
10820 CONTINUE
      WRITE(6,10810)'Digits =',ISIGFG
      GOTO 10062
10830 CONTINUE
      WRITE(6,10160)'Device -'
      CALL TXDEVS
      GOTO 10062
10840 CONTINUE
      IF (flags(60)) then
      WRITE(6,10160)'Clear -         Deferred'
      else
      WRITE(6,10160)'Clear -         Immediate'
      endif
      GOTO 10062
10850 CONTINUE
      I = 1
      IF (ERRFIL .eq. 6) I=2
      IF (ERRFIL .eq. OUTFIL) I=3
      J = 4
      IF (FLAGS(26)) J=5
      WRITE(6,10230)'Errors -',CERR(I),CERR(J)
      IF (FLAGS(58)) THEN
      REWIND(UNIT=86)
      I=0
10861 CONTINUE
      READ(86,'(A)',END=10870,ERR=10870) OUTSTR 
      JMAX = T2BTRIM ( OUTSTR ) 
      IF (I.eq.0) WRITE(6,10160) '  Errors for this plot'
      I=I+1
      IF (JMAX.le.0) THEN
      OUTSTR=' '
      JMAX=1
      ENDIF
      IF (.not.LTRAP) WRITE(6,10160)OUTSTR(1:JMAX)
      GOTO 10861
10862 CONTINUE
10870 CONTINUE
      ENDIF
      GOTO 10062
10880 CONTINUE
      CALL T2_SHOW_ON_OFF(' EXACT -',130)
      GOTO 10062
10890 CONTINUE
      WRITE(6,10160)'File -'
      DO 10901 I=INPFIL,9,-1
      CALL T2_SHOW_FILE(I, 'Input    ')
10901 CONTINUE
10902 CONTINUE
      CALL T2_SHOW_FILE(OUTFIL, 'Output   ')
      CALL T2_SHOW_FILE(JOUFIL, 'Journal  ')
      CALL T2_SHOW_FILE(ERRFIL, 'Error    ')
      CALL T2_SHOW_FILE(2,'Histogram')
      DO 10911 I=1,99
      IF(I.ge.9 .and. I .le.INPFIL)GOTO 10911
      IF(I.eq.OUTFIL .or. I.eq.JOUFIL .or. I.eq.ERRFIL .or. I.eq.2)GOTO 
     *10911
      CALL T2_SHOW_FILE(I, 'Misc.    ')
10911 CONTINUE
10912 CONTINUE
      GOTO 10062
10920 CONTINUE
      WRITE(6,10160)'Fill -'
      DO 10931 I=1,MAX_FILL
      OUTSTR=CUNIT1
      TEMP=FILL_WIDTH(I)
      IF (TEMP .lt. 0) THEN
      OUTSTR=' pixels'
      ENDIF
      WRITE(6,'(3x,A,I10)')'Entry',I
      WRITE(6,10140)'  Size=', TEMP,OUTSTR(:T2BTRIM(OUTSTR))
      WRITE(6,10140)'  Angle=',ASIN(FILL_ANGLE(I))*57.295779513,'deg.'
      J=2
      IF ( IAND(1,FILL_TEX(I)) .eq. 0 ) J=1
      WRITE(6,10230)'  Alternate=',ONOFF(J)
      CALL T2_SHOW_TEXTURE(FILL_TEX(I),0)
10931 CONTINUE
10932 CONTINUE
      GOTO 10062
10940 CONTINUE
      LTEMP=.false.
      GOTO 10951
10980 CONTINUE
      LTEMP=LTOKEN
      GOTO 10951
10960 GOTO ( 10980,10955),KEYORD
10955 CONTINUE
      INFOIN(9)=-1
      GOTO 10952
10951 CALL TOKEN(INFOIN,CARDIN,'FULL:Y,;')
      GOTO (10952,10960,10955,10955,10955,10955,10955,10960,10955),INTER
     *P
10952 CONTINUE
      CALL T2_SHOW_FIT(6,LTEMP)
      GOTO 10062
10990 CONTINUE
      CALL T2_SHOW_ON_OFF('Flush -',-54)
      GOTO 10062
11000 CONTINUE
      I=LETSET
      IF (I.eq.0) I=2
      WRITE(6,10230)'Font -',CFONT(I)
      CALL GET_DEFAULT_CASE(DCASE)
      WRITE(6,10230)'Case -',''''//DCASE//''''
      GOTO 10062
11010 CONTINUE
      WRITE(6,10230)'Format -',INPFMT
      GOTO 10062
11020 CONTINUE
      J=2
      IF (IAND(GRDTYP,15+128).gt.0) J=1
      K=2
      IF (IAND(DGRDTYP,15+128).gt.0) K=1
      WRITE(6,10210)'Grid  -',ONOFF(J),ONOFF(K)
      L=1
      DO 11031 I=1,MAXGRDTYP
      J=2
      IF (IAND(GRDTYP,L).gt.0) J=1
      K=2
      IF (IAND(DGRDTYP,L).gt.0) K=1
      IF (J+K.ne.4) THEN
      WRITE(6,10210)CGRTYP(I),ONOFF(J),ONOFF(K)
      ENDIF
      L=L*2
11031 CONTINUE
11032 CONTINUE
      SYM=T2_GET_SYMBOL(GRDSYM)
      SYM1=T2_GET_SYMBOL(DGRDSYM)
      WRITE(6,10210)'  Symbol=',SYM,SYM1
      WRITE(6,10170)'  Size=',GRDSIZ*REDUCE(3)  ,DGRDSIZ*REDUCE(3),CUNIT
     *2(:NUNIT2)
      I=1
      IF ( FLAGS(71) )I=2
      J=1
      IF ( DFLAGS(71) )J=2
      WRITE(6,10210)' ',CSET(I),CSET(J)
      WRITE(6,10170)'  Theta=',GRDIR(1),DGRDIR(1),'deg.'
      WRITE(6,10170)'  Phi=',GRDIR(2),DGRDIR(2)
      WRITE(6,10170)'  Angle=',GRDIR(3),DGRDIR(3)
      CALL T2_SHOW_TEXTURE(GRDTEX,DGRDTEX)
      GOTO 10062
11040 CONTINUE
      CALL T2_SHOW_HIST(INFOIN,CARDIN)
      GOTO 10062
11050 CONTINUE
      CALL T2_MESH_LIST_HORIZ
      GOTO 10062
11060 CONTINUE
      I=0
      GOTO 11071
11100 CONTINUE
      CALL T2SKEY(6,LTRAP,STRNG(1:NSTRNG))
      I=I+1
      GOTO 11071
11080 GOTO ( 11100,11100,11100,11100,11100,11100,11100,11100,11100,11100
     *,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100
     *,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100
     *,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100
     *,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100,11100
     *,11100,11100,11100,11075),KEYORD
11075 CONTINUE
      INFOIN(9)=-1
      IF (I.eq.0) CALL T2SKEY(6,LTRAP,' ')
      GOTO 11072
11110 CONTINUE
      INFOIN(9)=-1
      IF (I.eq.0) CALL T2SKEY(6,LTRAP,' ')
      GOTO 11072
11071 CALL TOKEN(INFOIN,CARDIN,'ALL:0,PF:0,PF1:0,PF2:0,PF3:0,PF4:0,KP:0,
     *KP0:0,KP1:0,KP2:0,KP3:0,KP4:0,KP5:0,KP6:0,KP7:0,KP8:0,KP9:0,E:0,E1
     *:0,E2:0,E3:0,E4:0,E5:0,E6:0,F:0,F1:0,F2:0,F3:0,F4:0,F5:0,F6:0,F7:0
     *,F8:0,F9:0,F10:0,F11:0,F12:0,F13:0,F14:0,F15:0,F16:0,F17:0,F18:0,F
     *19:0,F20:0,MINUS:0,PERIOD:0,COMMA:0,ENTER:0,FIND:0,INSERT:0,REMOVE
     *:0,SELECT:0,PREV_SCREEN:0,NEXT_SCREEN:0,HELP:0,DO,;')
      GOTO (11110,11080,11075,11075,11075,11075,11075,11080,11075),INTER
     *P
11072 CONTINUE
      GOTO 10062
11120 CONTINUE
      WRITE(6,10160)'Intensity/Line -'
      WRITE(6,10270)'  Width=',LINWID,LINWDF
      GOTO 10062
11130 CONTINUE
      WRITE(6,10160)'Labels -'
      CALL T2_SHOW_AXIS(36,47)
      WRITE(6,11140)'  Shift=',FRELBL
      WRITE(6,11140)'    Default:',DFRELBL
      WRITE(6,10170)'  Size='  ,LBLSIZ*REDUCE(3),DLBLSIZ*REDUCE(3),CUNIT
     *2(:NUNIT2)
      I=1
      IF ( FLAGS(77) )I=2
      J=1
      IF ( DFLAGS(77) )J=2
      WRITE(6,10210)' ',CSET(I),CSET(J)
      WRITE(6,10270)'  Chars=',LBLCHR(2),DLBLCHR(2)
      CALL T2_SHOW_ON_OFF('  Inside=',94)
      CALL T2_SHOW_TEXTURE(LABTEX,DLABTEX)
      GOTO 10062
11150 CONTINUE
      WRITE (6,10160)'Lexicals -'
      GOTO 11161
11170 CONTINUE
      WRITE(6,*)'   ', CARDIN(INFOIN(5):INFOIN(3)),'=',FLOTNG
      GOTO 11161
11180 CONTINUE
      IF (NSTRNG.gt.0) THEN
      WRITE(6,*)'   ',CARDIN(INFOIN(5):INFOIN(3)), '="'//STRNG(1:NSTRNG)
     *//'"'
      ELSE
      WRITE(6,*)'   ""'
      ENDIF
      GOTO 11161
11165 CONTINUE
      INFOIN(9)=-1
      GOTO 11162
11161 CALL TOKEN(INFOIN,CARDIN,';')
      GOTO (11162,11165,11170,11170,11180,11165,11165,11165,11165),INTER
     *P
11162 CONTINUE
      GOTO 10062
11190 CONTINUE
      WRITE(6,10160)'Limits -'
      DO 11201 I=1,3
      DO 11211 J=1,2
      K=2*I+J+2
      WRITE(OUTSTR,11220)CLIMIT(I,J),XYZLIM(I,J), 'Default:',DXYZLIM(I,J
     *)
      IF (.NOT. (FLAGS(K).or.FLAGS(60+K))) OUTSTR(16:16+16)='   NONE'
      IF (.NOT. DFLAGS(60+K)) OUTSTR(49:49+16)='   NONE'
      WRITE(6,10160)OUTSTR(3:49+16)
11211 CONTINUE
11212 CONTINUE
11201 CONTINUE
11202 CONTINUE
      IF (FLAGS(85)) WRITE(6,10140)'  Radius=',RADMAX
      IF (FLAGS(13)) WRITE(6,10140)'  Scale=',DSCAL
      GOTO 10062
11230 CONTINUE
      WRITE(6,10160)'Mode -'
      I=2
      IF (FLAGS(92))I=1
      WRITE(6,10230)'  ABORT',ONOFF(I)
      CALL T2_SHOW_ON_OFF('  APPEND',-106)
      CALL T2_SHOW_ON_OFF('  AUTOPLOT',-97)
      CALL T2_SHOW_ON_OFF('  CONFIRM',-104)
      CALL T2_SHOW_ON_OFF('  CHECK',-105)
      CALL T2_SHOW_ON_OFF('  DATAVECTOR',-102)
      I=2
      IF (FLAGS(29))I=1
      WRITE(6,10230)'  DEBUG',ONOFF(I)
      WRITE(6,10810)'  ECHO=',MXECHO
      WRITE(6,10230)'  ERASE',ONOFF(2-IERASE)
      CALL T2_SHOW_ON_OFF('  EXPAND',-17)
      WRITE(6,10230)'  FILECASE',CASE(IFILE_CASE+1)
      WRITE(6,10230)'  HARDSTRUCT',ONOFF(IHTEX+1)
      I=2
      IF (JOUFIL.gt.0) I=1
      WRITE(6,10230)'  JOURNALING',ONOFF(I)
      CALL T2_SHOW_ON_OFF('  LOG',-95)
      I=2
      IF (OUTFIL.gt.0) I=1
      WRITE(6,10230)'  LISTING',ONOFF(I)
      CALL T2_SHOW_ON_OFF('  PATTERNED',-101)
      CALL T2_SHOW_ON_OFF('  MONITOR',-107)
      WRITE(6,10230)'  PROPORTIONAL',ONOFF(IPROP+1)
      CALL T2_SHOW_ON_OFF('  QUICK',-83)
      CALL T2_SHOW_ON_OFF('  SHOW',-16)
      CALL T2_SHOW_ON_OFF('  TITLE',-108)
      CALL T2_SHOW_ON_OFF('  TREE',-103)
      I=2
      IF (FLAGS(18))I=1
      WRITE(6,10230)'  TRACE        ',ONOFF(I)
      CALL T2_SHOW_ON_OFF('  VECTOR',-25)
      CALL T2_SHOW_ON_OFF('  VLOG',-96)
      GOTO 10062
11240 CONTINUE
      CALL T2_SHOW_MONITOR
      GOTO 10062
11250 CONTINUE
      DO 11261 I=1,19
      IF (FLAGS(RELFLAG-1+I)) THEN
      J=INDEX(CORDER(I),'D')
      IF (J .ne. 0) CORDER(I)(J:J)='R'
      ENDIF
11261 CONTINUE
11262 CONTINUE
      WRITE(6,10160)'Order -'
      CALL T2_SHOW_ON_OFF('  Packed=',12)
      IMAX=1
      JMAX=1
      DO 11271 I=1,19
      IMAX=MAX(IMAX,IFIELD(I))
      JMAX=MAX(JMAX,IFLDDF(I))
11271 CONTINUE
11272 CONTINUE
      DO 11281 I=1,MAX(IMAX,JMAX)
      K=0
      L=0
      TEMP=0
      TEMP1=0
      DO 11291 J=1,19
      IF (IFIELD(J).eq.I .and. IVPTR(J) .gt. 0) THEN
      K=J
      TEMP=FACTXY(J)
      ENDIF
      IF (IFLDDF(J).eq.I) THEN
      L=J
      TEMP1=DFACTXY(J)
      ENDIF
11291 CONTINUE
11292 CONTINUE
      IF (I.gt.IMAX) K=0
      IF (I.gt.JMAX) L=0
      WRITE(6,'(3X,I3,1P,2A,G10.3,3A,G10.3)')  I,CORDER(K),' Scale=',TEM
     *P, ' Default:  ',CORDER(L),' Scale=',TEMP1
11281 CONTINUE
11282 CONTINUE
      GOTO 10062
11300 CONTINUE
      WRITE(6,10160)'Outline -'
      CALL T2_SHOW_AXIS(40,0)
      CALL T2_SHOW_INHIBIT(2)
      CALL T2_SHOW_TEXTURE(OUTTEX,DOUTTEX)
      GOTO 10062
11310 CONTINUE
      CALL T2_SHOW_ON_OFF('Pause=',-53)
      GOTO 10062
11320 CONTINUE
      WRITE(6,10160)'Pattern -'
      WRITE(6,10170)'  Size=',PATSZ,DPATSZ,CUNIT1(:NUNIT1)
      WRITE(6,'(1X,4(4X,''Draw'',5x,''Space''))')
      DO 11331 I=1,30
      IF (NPATRN(I).gt.1) THEN
      IF (I .le. 10) THEN
      WRITE(6,*)'  ',CPAT(I)
      ELSE
      WRITE(6,*)'  Cycle',I-10
      ENDIF
      WRITE(6,'(4X,1P,8G9.2)')(PATRN(J,I),J=1,NPATRN(I))
      ENDIF
11331 CONTINUE
11332 CONTINUE
      GOTO 10062
11340 CONTINUE
      WRITE(6,10270)'Pen number=',LINCOL,LINCLF
      GOTO 10062
11350 CONTINUE
      WRITE(6,10810)'Plots=',NPLOTS
      GOTO 10062
11360 CONTINUE
      I=2
      IF (FLAGS(27).and. .not.FLAGS(91))I=1
      K=2
      IF (DFLAGS(27).and. .not.DFLAGS(91))K=1
      WRITE(6,10210)'  Polar=',ONOFF(I),ONOFF(K)
      I=2
      IF (FLAGS(27).and. FLAGS(91))I=1
      K=2
      IF (DFLAGS(27).and. DFLAGS(91))K=1
      WRITE(6,10210)'  Spherical=',ONOFF(I),ONOFF(K)
      WRITE(6,10170)'  Circle=',PI/RADANG,PI/DRADANG
      GOTO 10062
11370 CONTINUE
      WRITE(6,10160)'Primary -'
      CALL T2_SHOW_TEXTURE(ITXPRI,IDTXPRI)
      GOTO 10062
11380 CONTINUE
      WRITE(6,10140)'Revision=',REVLEV
      GOTO 10062
11390 CONTINUE
      WRITE(6,10160)'Secondary -'
      CALL T2_SHOW_TEXTURE(ITXSEC,IDTXSEC)
      GOTO 10062
11400 CONTINUE
      DO 11411 I=1,7
      CALL T2_SHOW_ON_OFF(CSEGM(I),120+I)
11411 CONTINUE
11412 CONTINUE
      GOTO 10062
11420 CONTINUE
      WRITE(6,10160)'Scale -'
      DO 11431 IDEF=1,2
      IF (IDEF.eq.2) WRITE(6,10160)'- Default -'
      DO 11441 I=1,3
      IF (IDEF.eq.1) THEN
      ISCAL=NONLIN(I)
      DO 11451 J=1,10
      TEMPA(J)=SCLPRM(J,I)
11451 CONTINUE
11452 CONTINUE
      ITEMP1=NXYZ1(I)
      ITEMP2=NXYZ2(I)
      ELSE
      ISCAL=DNONLN(I)
      DO 11461 J=1,10
      TEMPA(J)=DSCLPRM(J,I)
11461 CONTINUE
11462 CONTINUE
      ITEMP1=DNXYZ1(I)
      ITEMP2=DNXYZ2(I)
      ENDIF
      IF (ISCAL.ge.0.or.ABS(ISCAL).gt.8) THEN
      WRITE(6,10810)'  '//CXYZ(I)//'User=',ISCAL
      WRITE(6,11140)'    Params=',(TEMPA(J),J=1,10)
      ELSE
      ISCAL=-ISCAL
      J1=1
      IF (ITEMP1.ge.0) J1=2
      J2=1
      IF (ITEMP2.gt.0) J2=2
      IF (ITEMP1.eq.0) ITEMP1=NXYZDEF1(ISCAL)
      IF (ITEMP2.eq.0) ITEMP2=NXYZDEF2(ISCAL)
      ITEMP3=ITEMP2
      ITEMP1=IABS(ITEMP1)
      ITEMP2=IABS(ITEMP2)
      ITEMP2=IAND(ITEMP2,2**16-1)
      J=ISCAL
      IF (ISCAL.eq.7) THEN
      T=TEMPA(4)
      DO 11471 K=1,3
      IF (T.gt.2) J=J+1
      T=T/60.
11471 CONTINUE
11472 CONTINUE
      ENDIF
      IF (ISCAL.eq.8) THEN
      WRITE(6,10230)  '  '//CXYZ(I),'Power'
      WRITE(6,10140)  '    Power=',TEMPA(4),'Base=',TEMPA(1)
      ELSE
      WRITE(6,10230)  '  '//CXYZ(I),CSCALE(J)
      IF (ABS(TEMPA(1)-10) .gt. 0.0000002) WRITE(6,10140)'    Base=',TEM
     *PA(1)
      ENDIF
      IF (ISCAL.eq.6) THEN
      WRITE(6,10140)  '    Mean=',TEMPA(2),'Dev.=',TEMPA(3)
      ENDIF
      IF (ISCAL.eq.2.or.ISCAL.eq.3 .and. IAND( ITEMP1,2**16) .eq. 0) THE
     *N
      IF (IAND(2**17,ITEMP1).eq.0) J1=0
      IDEC=IAND(31,ITEMP1/2**10)
      ITEMP1=IAND(ITEMP1,2**10-1)
      IF (ITEMP1.eq.2) ITEMP1=1023
      IF (ITEMP2.eq.2) ITEMP2=1023
      IMAX=0
      L=2
      DO 11481 K=2,9
      L=2*L
      IF (IAND(ITEMP1,L).ne.0) THEN
      IMAX=IMAX+1
      ITEMP(IMAX)=K
      ENDIF
11481 CONTINUE
11482 CONTINUE
      ITEMP(1)=0
      IF (ITEMP1.eq.1) IMAX=1
      ISUBT=ITEMP2/2**10
      ITEMP2=IAND(ITEMP2,2**10-1)
      ITEMP2=ITEMP2-IAND(ITEMP2,ITEMP1)
      IF (IDEC.gt.0) WRITE(6,'(7x,A,I3)') 'Decades/label= ',IDEC
      IF (ITEMP3.ge.0) J2=2
      IF (ABS(ITEMP3)+IMAX.gt.0) THEN
      WRITE(6,'(7x,3A,20I3)')  'Labels=',CSHORT(J2),' at',(ITEMP(K),K=1,
     *IMAX)
      ENDIF
      IF (J1.ne.0) WRITE(6,10160) '        Exponential='//ONOFF(J1)
      IMAX=0
      L=2
      DO 11491 K=2,9
      L=2*L
      IF (IAND(ITEMP2,L).ne.0) THEN
      IMAX=IMAX+1
      ITEMP(IMAX)=K
      ENDIF
11491 CONTINUE
11492 CONTINUE
      ITEMP(1)=0
      IF (ITEMP2.eq.1) IMAX=1
      IF (ITEMP3.le.0) J2=1
      IF (ABS(ITEMP3)+IMAX.gt.0) WRITE(6,'(7x,3A,20I3)') 'Ticks= ',CSHOR
     *T(J2),' at',(ITEMP(K),K=1,IMAX)
      IF (ISUBT.gt.0) WRITE(6,'(7x,2A,I3)') 'Subticks/tick=',CSHORT(1),I
     *SUBT
      ELSE
      ITEMP1=IAND(ITEMP1,2**16-1)
      IF(ITEMP1.ne.0) WRITE(6,10810) '    Labels=',ITEMP1,CSHORT(J1)
      IF(ITEMP2.ne.0) WRITE(6,10810) '    Ticks= ',ITEMP2,CSHORT(J2)
      ENDIF
      ENDIF
      IF (LSCREV(I)) WRITE(6,'(7x,A)')'Reverse'
11441 CONTINUE
11442 CONTINUE
11431 CONTINUE
11432 CONTINUE
      GOTO 10062
11500 CONTINUE
      J=2
      IF (IAND(SHADOWTYP,15*16).gt.0) J=1
      K=2
      IF (IAND(DSHADOWTYP,15*16).gt.0) K=1
      WRITE(6,10210)'Shadow  -',ONOFF(J),ONOFF(K)
      L=1
      DO 11511 I=1,MAXGRDTYP
      J=2
      IF (IAND(SHADOWTYP,L).gt.0) J=1
      K=2
      IF (IAND(DSHADOWTYP,L).gt.0) K=1
      IF (J+K.ne.4) THEN
      WRITE(6,10210)CGRTYP(I),ONOFF(J),ONOFF(K)
      ENDIF
      L=L*2
11511 CONTINUE
11512 CONTINUE
      CALL T2_SHOW_TEXTURE(SHADOWTEX,DSHADOWTEX)
      GOTO 10062
11520 CONTINUE
      WRITE(6,*)' Shielded areas (Text coordinates)'
      IF (.not. FLAGS(73)) CALL TXDEF1
      DO 11531 I=1,4
      CALL UGSHLD('GET,SHIELD='//DIGITS(I+1:I+1),XYSHLD)
      IF(FLAGS(23))GOTO 11532
      IF (XYSHLD(1,2) .ne. 0.0) THEN
      DO 11525 J=1,2
      GOTO (11521,11522,11523,11524),IROTAX+1
11521 XYDEV(1,J)=          XYSHLD(1,  J)
      XYDEV(2,J)=          XYSHLD(2,  J)
      GOTO 11525
11522 XYDEV(1,J)=PLIM(3,4)-XYSHLD(2,3-J)
      XYDEV(2,J)=          XYSHLD(1,  J)
      GOTO 11525
11523 XYDEV(1,J)=PLIM(3,4)-XYSHLD(1,3-J)
      XYDEV(2,J)=PLIM(4,4)-XYSHLD(2,3-J)
      GOTO 11525
11524 XYDEV(1,J)=          XYSHLD(2,  J)
      XYDEV(2,J)=PLIM(4,4)-XYSHLD(1,3-J)
      GOTO 11525
11525 CONTINUE
      CALL T2IFRM(2,2,XYDEV,LINEAR,XFRM34,2,XYSHLD)
      WRITE(6, '(3x,A,I3,1P,/,(5x,A,T16,G11.3,A,T38,G11.3))')  'Number='
     *,I,((CLIMIT(J,K),XYSHLD(J,K),J=1,2),K=2,1,-1)
      ENDIF
11531 CONTINUE
11532 CONTINUE
      GOTO 10062
11540 CONTINUE
      TEMP=REDUCE(1)
      IF(TEMP.eq.0.)TEMP=REDFAC
      WRITE(6,10140)'Size -', SCREEN(1),'by',SCREEN(2),CUNIT1(:NUNIT1)
      WRITE(6,10140)'  Reduce=',TEMP,'fraction'
      IF(REDFAC.ne.1.) WRITE(6,10160) '  Plot automatically reduced'
      IF(IROTAX.ne.0 ) WRITE(6,10810) '  Orientation',IROTAX,'Angle=',90
     **IROTAX
      WRITE(6,10230)  '  Margins:','Left','Right','Bottom','Top'
      WRITE(6,11140) ' ',MARGIN
      GOTO 10062
11550 CONTINUE
      IF (DATDAT(1,1).eq.HNONE) THEN
      WRITE(6,10160)'No statistics are available'
      ELSE
      IFILE=6
      LTOTAL=.true.
      GOTO 10790
      ENDIF
      GOTO 10062
11560 CONTINUE
      IOFF=1
      If(FLAGS(27)) IOFF=10
      WRITE(6,*)' Storage - ',(CORDER(IVARBL(I)),I=1,NINCR)
      WRITE(6,*) '   Words= ',NPTMAX-IVRPTR(14)+1, ' Free=',(NPTMAX-IVRP
     *TR(12)+1)
      IF(NINCR.gt.0) THEN
      WRITE(6,*)'   Points=',NPOINT,' Free=',(NPTMAX-IVRPTR(12)+1)/NINCR
     *
      ENDIF
      GOTO 10062
11570 CONTINUE
      CALL SYSTEM('env | grep TD_S_')
      GOTO 10062
11580 CONTINUE
      SYM=T2_GET_SYMBOL(SYMBOL)
      SYM1=T2_GET_SYMBOL(DSYMBOL)
      WRITE(6,10160)'Symbol -'
      WRITE(6,10210)'  Symbol=',SYM,SYM1
      WRITE(6,10170)'  Size='  ,SYMSIZ*REDUCE(3),SMSZDF*REDUCE(3),CUNIT2
     *(:NUNIT2)
      I=1
      IF( FLAGS(72) )I=2
      J=1
      IF( DFLAGS(72) )J=2
      WRITE(6,10210)' ',CSET(I),CSET(J)
      WRITE(6,10170)'  Theta=',SYDIR(1),DSYDIR(1),'deg.'
      WRITE(6,10170)'  Phi=',SYDIR(2),DSYDIR(2)
      WRITE(6,10170)'  Angle=',SYDIR(3),DSYDIR(3)
      GOTO 10062
11590 CONTINUE
      WRITE(6,10210)'Texture =',CTEX(LINTEX),CTEX(LINTXF)
      GOTO 10062
11600 CONTINUE
      I=2
      IF(FLAGS(56)) I=1
      K=2
      IF(DFLAGS(56)) K=1
      IF (NDIMNS(1).eq.0) K=3
      WRITE(6,10210)'Three -',ONOFF(I),ONOFF(K)
      CALL T2_SHOW_ON_OFF('  Perspective',120)
      WRITE(6,10230)' ','X','Y','Z'
      WRITE(OUTSTR,11610)'  Axis angle=',AXANG,'deg.'
      DO 11621 I=1,3
      IF(ABS(AXANG(I)) .gt. 360) THEN
      J=16+(I-1)*11
      OUTSTR(J:J+11)='   None'
      ENDIF
11621 CONTINUE
11622 CONTINUE
      ITEMP1=INDEX(OUTSTR,'deg.')+3
      WRITE(6,10160)OUTSTR(3:ITEMP1)
      WRITE(OUTSTR,11610)'    Default:',DAXANG,'deg.'
      DO 11631 I=1,3
      IF(ABS(DAXANG(I)) .gt. 360) THEN
      J=16+(I-1)*11
      OUTSTR(J:J+14)='   None'
      ENDIF
11631 CONTINUE
11632 CONTINUE
      WRITE(6,10160)OUTSTR(3:ITEMP1)
      DO 11641 I=1,3
      IF (ABS(VUECEN(I)).GT.1000.) THEN
      SUM(I)=0.5*WORLD(I)
      ELSE
      SUM(I)=VUECEN(I)
      ENDIF
11641 CONTINUE
11642 CONTINUE
      WRITE(6,11610)'  Center=',(SUM(I),I=1,3)  ,CUNIT1(:NUNIT1)
      IF(FLAGS(85)) THEN
      WRITE(6,11610)'  Origin=',ORAXES,CUNIT1(:NUNIT1)
      ENDIF
      IF(DFLAGS(85)) THEN
      WRITE(6,11610)'    Default:',DORAXES
      ENDIF
      TEMP=0
      DO 11651 I=1,3
      SUM(I)=VERTCL(I)
      TEMP=TEMP+ABS(SUM(I))
11651 CONTINUE
11652 CONTINUE
      IF(TEMP .eq. 0) SUM(3)=1
      WRITE(6,11610)'  Vertical=',(SUM(I),I=1,3),'vect.'
      TEMP=0
      DO 11661 I=1,3
      SUM(I)=DVERTCL(I)
      TEMP=TEMP+ABS(SUM(I))
11661 CONTINUE
11662 CONTINUE
      IF(TEMP .eq. 0) SUM(3)=1
      WRITE(6,11610)'    Default:',(SUM(I),I=1,3),'vect.'
      WRITE(6,11610)'  World=',WORLD,CUNIT1(:NUNIT1)
      IF(FLAGS(55)) THEN
      WRITE(6,11610)'  Direction=',EYEDIR,'vect.'
      ELSE
      WRITE(6,10140)'  Theta=',TTHETA, 'Phi=',TPHI,'deg.'
      ENDIF
      IF(DFLAGS(55)) THEN
      WRITE(6,11610)'    Def: Dir=',DEYEDIR,'vect.'
      ELSE
      WRITE(6,10140)'    Def:Thet=',DTTHETA, 'Phi=',DTPHI,'deg.'
      ENDIF
      WRITE(6,10170)'  Distance=',EYEDIS,DEYEDIS ,CUNIT1(:NUNIT1)
      WRITE(6,10170)'  Scrd=',SCRD,DSCRD,CUNIT1(:NUNIT1)
      WRITE(6,10170)'  Separation=',EYESEP,DEYESEP  ,CUNIT1(:NUNIT1)
      GOTO 10062
11670 CONTINUE
      WRITE(6,10160)'Ticks -'
      CALL T2_SHOW_AXIS(32,44)
      WRITE(6,10170)'  Size=',TIKSIZ(1),DTIKSIZ(1)  ,CUNIT1(:NUNIT1)
      I=1
      IF( FLAGS(78) )I=2
      J=1
      IF( DFLAGS(78) )J=2
      WRITE(6,10210)' ',CSET(I),CSET(J)
      WRITE(6,10170)'  Long=',TIKFAC,DTIKFAC,'ratio'
      CALL T2_SHOW_TEXTURE(TICTEX,DTICTEX)
      GOTO 10062
11680 CONTINUE
      WRITE(6,10160)'Time -'
      OUTSTR=' '
      CALL DATE(OUTSTR)
      CALL TDTIME(OUTSTR(11:18))
      WRITE(6,10230)'  Time=',OUTSTR(1:18)
      TEMP=RELTIM(OREAL)
      CALL T2CVTM(TEMP,CTEMP1)
      OREAL=RELTIM(0.0)
      CALL T2CVTM(OREAL,CTEMP)
      WRITE(6,10230)'  Elapsed=',Ctemp,' ','Diff=',CTEMP1
      TEMP=CPUTIM(OCPU)
      CALL T2CVTM(TEMP,CTEMP1)
      OCPU=CPUTIM(0.0)
      CALL T2CVTM(OCPU,CTEMP)
      WRITE(6,10230)'  Cputime=',CTEMP,' ','Diff=',CTEMP1
      TEMP=CPULIM(CPUTIM(0.0))
      IF(TEMP.ge.0) THEN
      CALL T2CVTM(TEMP,CTEMP)
      WRITE(6,10230)'  Cpuleft=',CTEMP
      ENDIF
      GOTO 10062
11690 CONTINUE
      WRITE(6,10160)'Title -'
      WRITE(6,10170)'  Size=', TITSIZ*REDUCE(3),DTITSIZ*REDUCE(3),CUNIT2
     *(:NUNIT2)
      I=1
      IF( FLAGS(76) )I=2
      J=1
      IF( DFLAGS(76) )J=2
      WRITE(6,10210)' ',CSET(I),CSET(J)
      CALL T2_SHOW_TEXTURE(TITEX,DTITEX)
      CALL T2_SHOW_AXIS(0,0)
      WRITE(6,11140)  '  Lines=', TITLIN
      WRITE(6,11140)  '    Default:',DTITLIN
      WRITE(6,11140)  '  Scale=', TITFAC
      WRITE(6,11140)  '    Default:',DTITFAC
      WRITE(6,11140)  '  Margin=', TITMAR
      WRITE(6,11140)  '    Default:',DTITMAR
      WRITE(6,10170)'  Index=',TITINX,DTITINX,'lines'
      WRITE(6,10230)  '  Current','Size','Angle','Space','Index','Lines'
     *
      WRITE(6,11140)' ',TITCON
      WRITE(6,10230)' ','X','Y','Z'
      WRITE(6,11140)' ',TITX,TITY,TITZ
      WRITE(6,10230)'  Current', CJUST(ITCNTR+1),'Justification'
      OUTSTR(:4)='"'//C_TIT_ESCAPE//'"'
      IF (OUTSTR(2:2).EQ.CHAR(0)) THEN
      OUTSTR(:4)='NONE'
      ENDIF
      WRITE(6,10230)'  Escape=',OUTSTR(:4)
      OUTSTR(:4)='"'//C_TIT_SUBSTITUTE//'"'
      IF (OUTSTR(2:2).EQ.CHAR(0)) THEN
      OUTSTR(:4)='NONE'
      ENDIF
      WRITE(6,10230)'  Substitute=',OUTSTR(:4)
      GOTO 10062
11700 CONTINUE
      WRITE(6,10140)'Units -'
      WRITE(6,10140)'  Character=',REDUCE(3)  ,'=',1/reduce(3)  ,cunit3/
     */' ='//CUNIT2(:NUNIT2)
      WRITE(6,10140)'  Text=',REDUCE(2)  ,'=',1/reduce(3)  ,cunit3//' ='
     *//CUNIT1(:NUNIT1)
      GOTO 10062
11710 CONTINUE
      CALL SYSTEM('env | grep TD_V_')
      GOTO 10062
11720 CONTINUE
      WRITE(6,11730)REVLEV
11730 FORMAT('  Version - ',F5.2,'  TopDrawer (Bonner Lab) ','Aug  9 199
     *5')
      GOTO 10062
10070 GOTO ( 10090,10110,10110,10150,10180,10180,10180,10190,10220,10220
     *,10220,10220,10250,10260,10260,10280,10290,10300,10310,10320,10360
     *,10380,10380,10380,10800,10820,10830,10840,10840,10850,10880,10890
     *,10890,10890,10920,10940,10990,11000,11010,11020,11040,11050,11060
     *,11060,11060,11120,11120,11130,11150,11190,11230,11240,11250,11300
     *,11300,11310,11310,11320,11340,11350,11360,11360,11370,11380,11390
     *,11400,11420,11500,11520,11540,11550,11560,11570,11580,11590,11590
     *,11600,11670,11680,11690,11700,11710,11720,10065),KEYORD
11740 CONTINUE
      GOTO 10020
10065 CONTINUE
      CALL T2ERR(INFOIN,CARDIN,' ',5)
      GOTO 10020
C0061 CALL TOKEN(INFOIN,CARDIN,'ALL,AREA,WINDOWS,ARROW,AX,AXIS,AXES,BAR,
C    *BOX:1,DIAMOND:2,CIRCLE:3,ELLIPSE:3,BLINK,CARD,INPUT,CHARACTERS,COL
C    *OR,CTRL_Z,COMMANDS,CURSOR,CYCLE,DA,DAT,DATA,DATE,DIGITS,DEVICE,CLE
C    *AR,ERASE,ERRORS,EXACT,FI,FIL,FILES,FILL,FIT,FLUSH,FONT,FORMAT,GRID
C    *,HISTOGRAMS,HORIZON,KEY:0,KEYS:0,KEYPAD:0,INTENSITY,WIDTH,LABELS,L
C    *EXICALS,LIMITS,MODE,MONITOR,ORDER,OUTLINE,FRAME,PAUSE,WAIT,PATTERN
C    *,PEN,PLOTS,POLAR,SPHERICAL,PRIMARY,REVISION,SECONDARY,SEGMENTS,SCA
C    *LES,SHADOW,SHIELDS,SIZE,STATISTICS,STORAGE,STRINGS,SYMBOL,TEXTURE,
C    *STRUCTURE,THREE,TICKS,TIME,TITLES,UNITS,VALUES,VERSION,;')
10061 TKSTR(:264)=             'ALL,AREA,WINDOWS,ARROW,AX,AXIS,AXES,BAR,
     *BOX:1,DIAMOND:2,CIRCLE:3,ELLIPSE:3,BLINK,CARD,INPUT,CHARACTERS,COL
     *OR,CTRL_Z,COMMANDS,CURSOR,CYCLE,DA,DAT,DATA,DATE,DIGITS,DEVICE,CLE
     *AR,ERASE,ERRORS,EXACT,FI,FIL,FILES,FILL,FIT,FLUSH,FONT,FORMAT,GRID
     *,HISTOGRAMS,HORIZON,KEY:0,'
      TKSTR(265:)=             'KEYS:0,KEYPAD:0,INTENSITY,WIDTH,LABELS,L
     *EXICALS,LIMITS,MODE,MONITOR,ORDER,OUTLINE,FRAME,PAUSE,WAIT,PATTERN
     *,PEN,PLOTS,POLAR,SPHERICAL,PRIMARY,REVISION,SECONDARY,SEGMENTS,SCA
     *LES,SHADOW,SHIELDS,SIZE,STATISTICS,STORAGE,STRINGS,SYMBOL,TEXTURE,
     *STRUCTURE,THREE,TICKS,TIME,TITLES,UNITS,VALUES,VERSION,;'
      CALL TOKEN(INFOIN,CARDIN,TKSTR)
      GOTO (11740,10070,10065,10065,10065,10065,10065,10070,10065),INTER
     *P
10062 CONTINUE
      GOTO 10051
10052 CONTINUE
10020 CONTINUE
      NSTJOU=0
      LSTJOU=0
10160 FORMAT(2X,A)
10810 FORMAT(2X,A,T16,I7,T30,A,T38,I7,T52,A,T60,I7)
10270 FORMAT(2X,A,T16,I7,T30,'Default:',T38,I7,T52,A)
11610 FORMAT(2X,A,T16,1p,3G11.3,T63,A)
10230 FORMAT(2X,A,T19,A,T30,A,T41,A,T52,A,T63,A)
10210 FORMAT(2X,A,T19,A,T30,'Default:',T41,A)
10140 FORMAT(2X,A,T16,1P,G11.3,T30,A,T38,G11.3,T52,A)
10170 FORMAT(2X,A,T16,1P,G11.3,T30,'Default:',T38,G11.3,T52,A)
11140 FORMAT(2X,A,1P,(T16,5G11.3))
10120 FORMAT(2X,A,T16,1P,G11.3,T30,A,T38,G11.3,T52,A,T60,I7)
11220 FORMAT(2X,A,T16,1P,G15.7,T41,A,T49,G15.7)
      END
      SUBROUTINE T2GVNM(N,NAME)
      IMPLICIT NONE
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      REAL HNONE
      INTEGER LISTPT,NPTMAX,NDSETS
      REAL DATBUF(10248)
      COMMON /T2XPNT/ LISTPT,NPTMAX,NDSETS,DATBUF
      CHARACTER*(*) NAME
      INTEGER I,J,N
      CHARACTER*7 CORDER(28)
      DATA HNONE /-666.666/
      DATA CORDER/ ' Symbol', ' X', ' Dx', ' Y', ' Dy', ' Z', ' Dz', ' N
     *Dx', ' NDy', ' NDz', ' U', ' Du', ' NDu', ' V', ' Dv', ' NDv', ' W
     *', ' Dw', ' NDw', ' Theta', ' Dtheta', ' Radius', ' Drad', ' Phi',
     * ' Dphi', ' NDthet', ' NDrad', ' NDphi'/
      I=I_VORDER(N,2)  ! ??
      IF (I.ge.1 .and. I.le.19) THEN
      IF ( (I.gt.1 .and.I .le. 10) .and. (FLAGS(91) .OR. (FLAGS(27).and.
     * (I.le.5 .or. I.eq.8 .or. I .eq. 9)) ) ) THEN
      J=18
      ELSE
      J=0
      ENDIF
      NAME=CORDER(I+J)
      ELSE
      NAME='******'
      ENDIF
      END
      SUBROUTINE T2CVTM(TIME,CTIME)
      IMPLICIT NONE
      CHARACTER*(*) CTIME
      CHARACTER*10 CTEMP
      REAL TEMP,TIME
      INTEGER ITEMP,IHR,MINUTE
      CTIME=' '
      TEMP=TIME
      TEMP=ABS(TEMP)
      IHR=TEMP/3600.
      TEMP=TEMP-IHR*3600.
      MINUTE=TEMP/60
      TEMP=TEMP-MINUTE*60
      TEMP=ABS(TEMP)
      IHR=MIN(IHR,99)
      WRITE(CTEMP,'(I10)')IHR
      CTIME(1:3)=CTEMP(9:10)//':'
      WRITE(CTEMP,'(I10.2)')MINUTE
      CTIME(4:6)=CTEMP(9:10)//':'
      WRITE(CTEMP,'(F10.2)')TEMP
      CTIME(7:11)=CTEMP(6:10)
      IF(CTIME(7:7).eq.' ')CTIME(7:7)='0'
      END
      SUBROUTINE T2CURS(I,XYZ,XYZ1,XYZ2,F1,F2)
      IMPLICIT NONE
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      integer I,J
      real xyz(2),xyz1(2),xyz2(3)
      LOGICAL f1,f2
      IF (.NOT.FLAGS(73)) CALL TXDEF1
      f1 = .false.
      f2=.false.
      CALL TXVOID
      DO 11751 I=1,3
      IF( FLAGS(73) ) F1=.true.
      IF( FLAGS(75) ) F2=.true.
11751 CONTINUE
11752 CONTINUE
      I = 0
      IF( F1 .or. F2) THEN
      CALL TXCURS(XYZ(1),XYZ(2),I)
      IF(I .eq. 0) THEN
      F1=.false.
      F2=.false.
      endif
      IF(F1) CALL T2IFRM(2,1,XYZ,LINEAR,XFRM34,2,XYZ1)
      IF(F2) CALL T2IFRM(2,1,XYZ,NONLIN,XFRM14,3,XYZ2)
      ENDIF
      end
      SUBROUTINE T2_LIST(INFOIN,CARDIN)
      IMPLICIT NONE
      INTEGER INFOIN(10)
      CHARACTER*(*) CARDIN
      INTEGER NSETD 
      PARAMETER (NSETD=19+9)
      INTEGER ISETD(NSETD),NINCR0,NINCR1,NINCR2,IBTYPE
      INTEGER I1,I2,I3,I4,I5,I6,I7,IM,NP,NL,IENDAT,IBGDAT
      INTEGER I_NDX,I_NDY,I_NDZ
      INTEGER N_SYMBOL 
      INTEGER N_XDATA 
      INTEGER N_DXDATA 
      INTEGER N_NDXDATA 
      INTEGER N_YDATA 
      INTEGER N_DYDATA 
      INTEGER N_NDYDATA 
      INTEGER N_ZDATA 
      INTEGER N_DZDATA 
      INTEGER N_NDZDATA 
      INTEGER N_UDATA 
      INTEGER N_DUDATA 
      INTEGER N_NDUDATA 
      INTEGER N_VDATA 
      INTEGER N_DVDATA 
      INTEGER N_NDVDATA 
      INTEGER N_WDATA 
      INTEGER N_DWDATA 
      INTEGER N_NDWDATA 
      INTEGER NCMAX 
      INTEGER NCSIZE 
      INTEGER NBTYPE 
      INTEGER NINDAT 
      INTEGER NSDATA 
      INTEGER NXDATA 
      INTEGER NDXDATA 
      INTEGER NNDXDATA 
      INTEGER NYDATA 
      INTEGER NDYDATA 
      INTEGER NNDYDATA 
      INTEGER NZDATA 
      INTEGER NDZDATA 
      INTEGER NNDZDATA 
      INTEGER NPDATA 
      INTEGER NLDATA 
      INTEGER NMDATA 
      INTEGER NBGDAT 
      INTEGER NENDAT 
      PARAMETER (N_SYMBOL=1) 
      PARAMETER (N_XDATA=2) 
      PARAMETER (N_DXDATA=3) 
      PARAMETER (N_NDXDATA=4) 
      PARAMETER (N_YDATA=5) 
      PARAMETER (N_DYDATA=6) 
      PARAMETER (N_NDYDATA=7) 
      PARAMETER (N_ZDATA=8) 
      PARAMETER (N_DZDATA=9) 
      PARAMETER (N_NDZDATA=10) 
      PARAMETER (N_UDATA=11) 
      PARAMETER (N_DUDATA=12) 
      PARAMETER (N_NDUDATA=13) 
      PARAMETER (N_VDATA=14) 
      PARAMETER (N_DVDATA=15) 
      PARAMETER (N_NDVDATA=16) 
      PARAMETER (N_WDATA=17) 
      PARAMETER (N_DWDATA=18) 
      PARAMETER (N_NDWDATA=19) 
      PARAMETER (NCMAX=6) 
      PARAMETER (NCSIZE=3) 
      PARAMETER (NBTYPE=1) 
      PARAMETER (NINDAT=2) 
      PARAMETER (NSDATA=5) 
      PARAMETER (NXDATA=NSDATA+1) 
      PARAMETER (NDXDATA=NXDATA+1) 
      PARAMETER (NNDXDATA=NXDATA+2) 
      PARAMETER (NYDATA=NXDATA+NCSIZE) 
      PARAMETER (NDYDATA=NYDATA+1) 
      PARAMETER (NNDYDATA=NYDATA+2) 
      PARAMETER (NZDATA=NYDATA+NCSIZE) 
      PARAMETER (NDZDATA=NZDATA+1) 
      PARAMETER (NNDZDATA=NZDATA+2) 
      PARAMETER (NPDATA=NSDATA+19) 
      PARAMETER (NLDATA=NPDATA+1) 
      PARAMETER (NMDATA=NLDATA+1) 
      PARAMETER (NBGDAT=NMDATA+1) 
      PARAMETER (NENDAT=NBGDAT+1) 
      EQUIVALENCE (IBTYPE,ISETD(NBTYPE))
      EQUIVALENCE (NINCR0,ISETD(NINDAT))
      EQUIVALENCE (NINCR1,ISETD(NINDAT+1))
      EQUIVALENCE (NINCR2,ISETD(NINDAT+2))
      EQUIVALENCE (I7,ISETD(NSDATA))
      EQUIVALENCE (I1,ISETD(NXDATA))
      EQUIVALENCE (I4,ISETD(NDXDATA))
      EQUIVALENCE (I2,ISETD(NYDATA))
      EQUIVALENCE (I5,ISETD(NDYDATA))
      EQUIVALENCE (I3,ISETD(NZDATA))
      EQUIVALENCE (I6,ISETD(NDZDATA))
      EQUIVALENCE (I_NDX,ISETD(NNDXDATA))
      EQUIVALENCE (I_NDY,ISETD(NNDYDATA))
      EQUIVALENCE (I_NDZ,ISETD(NNDZDATA))
      EQUIVALENCE (NP,ISETD(NPDATA))
      EQUIVALENCE (NL,ISETD(NLDATA))
      EQUIVALENCE (IM,ISETD(NMDATA))
      EQUIVALENCE (IBGDAT,ISETD(NBGDAT))
      EQUIVALENCE (IENDAT,ISETD(NENDAT))
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      LOGICAL LAPPEN, LCONF, LMONITOR, LCHECK, LLOG
      INTEGER N1,N2,N3,N4,NS1,NS2
      REAL TLIM(3,2)
      COMMON /T2SELECT/N1 ,N2 ,N3 ,N4 ,NS1 ,NS2 ,TLIM ,LMONITOR ,LAPPEN
     * ,LCONF ,LLOG ,LCHECK
      REAL HNONE
      INTEGER LISTPT,NPTMAX,NDSETS
      REAL DATBUF(10248)
      COMMON /T2XPNT/ LISTPT,NPTMAX,NDSETS,DATBUF
      LOGICAL LSTAT,LVALU, LCOMP,LZ,LHEADER
      CHARACTER*10 C_ACCESS
      CHARACTER*3 C_STATUS
      CHARACTER*4 SYM,T2_GET_SYMBOL
      CHARACTER*2 CXYZ(4)
      CHARACTER*7 CORDER(19)
      INTEGER T2BTRIM
      INTEGER I,J,K,JLIM,LUN,IOFF,IMAX,NLIM
      INTEGER ISET,INDEP,IDEP
      REAL DVEC(19),TARR(8),ZMIN,ZMAX,TEMP,SETNUM,TEMP1,DTEMP1
      REAL DLIM(3,2)
      REAL*8 SUM(8)
      REAL XYZ1(2),XYZ2(3),XYZ0(2)
      CHARACTER*4 QUOTES
      DATA QUOTES /'"  "'/
      DATA HNONE /-666.666/
      DATA CXYZ/'X=','Y=','Z=',' '/
      DATA CORDER/19*' '/
      C_STATUS='NEW'
      C_ACCESS='SEQUENTIAL'
      LUN=OUTFIL
      IF(LUN .le. 0) LUN=6
      DO 11761 I=1,19
      CALL T2GVNM(I,CORDER(I))
11761 CONTINUE
11762 CONTINUE
      LCOMP=.false.
      LSTAT=.true.
      LVALU=.true.
      LHEADER=.true.
      N_FILE=0
      GOTO 11771
11800 CONTINUE
      IF (LTOKEN) THEN
      C_STATUS='OLD'
      C_ACCESS='APPEND'
      ELSE
      C_STATUS='NEW'
      C_ACCESS='SEQUENTIAL'
      ENDIF
      GOTO 11771
11810 CONTINUE
      LUN=1
      C_FILE=STRNG
      N_FILE=NSTRNG
      CALL T2_SET_DEFAULT_FILE(C_FILE,N_FILE,'tdata.lis')
      GOTO 11771
11820 CONTINUE
      LHEADER=LTOKEN
      GOTO 11771
11830 CONTINUE
      CALL T2NSET(INFOIN,CARDIN,NS1,NS2)
      GOTO 11771
11840 CONTINUE
      C_SELECT=STRNG
      N_SELECT=MAX(1,NSTRNG)
      GOTO 11771
11850 CONTINUE
      CALL T2PNTS(INFOIN,CARDIN,N1,N2)
      GOTO 11771
11860 CONTINUE
      CALL T2ROWS(INFOIN,CARDIN,N3,N4)
      GOTO 11771
11870 CONTINUE
      LSTAT=LTOKEN
      LVALU=.not. LTOKEN
      GOTO 11771
11880 CONTINUE
      LCOMP=LTOKEN
      GOTO 11771
11890 CONTINUE
      LLOG =LTOKEN
      GOTO 11771
11900 CONTINUE
      CALL T2XYZC(INFOIN,CARDIN,TLIM,2,NLIM)
      GOTO 11771
11771 CALL TOKEN(INFOIN,CARDIN,'APPEND:Y,FILE:F,OUTPUT:F,HEADER,SETS,SEL
     *ECT:S,POINTS,COLUMNS,LINES,ROWS,STATISTICS:Y,COMPRESS:Y,LOG:Y,LIMI
     *TED,;')
      GOTO (11772,11777,11775,11775,11775,11775,11771,11777, 11775),INTE
     *RP
11775 CALL T2ERR(INFOIN,CARDIN,' ',5)
      GOTO 11771
11777 GOTO ( 11800,11810,11810,11820,11830,11840,11850,11850,11860,11860
     *,11870,11880,11890,11900,11775),KEYORD
11772 CONTINUE
      IF(FLAGS(23).and.FLAGS(92)) RETURN
      LSTAT=LSTAT .and. .not. LCOMP
      IF (N_FILE .gt. 0) THEN
      OPEN(UNIT=LUN ,FILE=C_FILE(1:N_FILE)  ,STATUS=C_STATUS    ,ACCESS=
     *C_ACCESS    ,ERR=11910)
      IF (LUN.le.20) NINP(LUN)=0
      ENDIF
      DO 11921 ISET=NS1,NS2
      CALL T2GDSET(ISET,N1,N2,N3,N4,ISETD,TLIM,C_SELECT(:N_SELECT))
      IF(NP .lt. N1)GOTO 11921
      CALL T2_GET_SET_NAME(IBGDAT,C_NAME)
      N_NAME=T2BTRIM(C_NAME)
      JLIM=0
      IF (TLIM(1,1) .ne. HNONE) THEN
      JLIM=2
      IF (DATBUF(I3).ne.HNONE) JLIM=3
      ENDIF
      DO 11931 I=1,8
      SUM(I)=0.0
11931 CONTINUE
11932 CONTINUE
      IF(IBTYPE.eq.2) THEN
      INDEP=MESH1*2
      IDEP=MESH2*2
      IF (LLOG) WRITE(6,*)'  List - ',CXYZ(MESH3),' vs ', CXYZ(MESH2),NI
     *NCR2-1,' by ',CXYZ(MESH1),NINCR1-1, ' Set=',ISET,' Name=','"'//C_N
     *AME(:N_NAME)//'"'
      ZMIN=1.0E35
      ZMAX=-1.0E35
      IF (LVALU) THEN
      WRITE(LUN,*)'READ MESH'
      IF (NINCR0 .eq.2) WRITE(LUN,*)' WITH ERROR'
      WRITE(LUN,'(A)') '   NAME="'//C_NAME(:N_NAME)//'"'
      NP=NINCR0*(NP-N1+1)
      K=MESH1
      DO 11941 I=0,NP-1,8*nincr0
      WRITE(OUTSTR,'(2x,1p,A,T5,8G15.6)') CXYZ(K), (DATBUF(I1+J),J=I,MIN
     *(I+nincr0*8-1,NP-1),nincr0)
      CALL T2WRSQ(OUTSTR,LCOMP,LUN,1)
      K=4
11941 CONTINUE
11942 CONTINUE
      ENDIF
      DO 11951 I=N3,NL
      IF(LTRAP) GOTO 11960
      IF (LVALU) THEN
      K=MESH3
      DO 11971 J=0,NP-1,8
      IF (J.eq.0) THEN
      WRITE(OUTSTR,'(2x,A,1p,T5,4G15.6)')  CXYZ(MESH2),DATBUF(I2)
      CALL T2WRSQ(OUTSTR,LCOMP,LUN,1)
      ENDIF
      WRITE(OUTSTR,'(2x,A,T5,8G15.6)')  CXYZ(K),(DATBUF(I3+K),K=J,MIN(J+
     *7,NP-1))
      CALL T2WRSQ(OUTSTR,LCOMP,LUN,1)
      K=4
11971 CONTINUE
11972 CONTINUE
      ENDIF
      IF (LSTAT) THEN
      DO 11981 J=0,NP-1,NINCR0
      IF(LTRAP) GOTO 11960
      TEMP=DATBUF(I3+J)
      SUM(1)=SUM(1)+TEMP
      SUM(8)=SUM(8)+1.
      IF(TEMP.lt.ZMIN)ZMIN=TEMP
      IF(TEMP.gt.ZMAX)ZMAX=TEMP
11981 CONTINUE
11982 CONTINUE
      ENDIF
      I2=I2+NINCR0*NINCR1
      I3=I3+NINCR0*NINCR1
11951 CONTINUE
11952 CONTINUE
      ELSEIF (NP.ge.N1) THEN
      DO 11991 J=1,8
      DVEC(I)=0
11991 CONTINUE
11992 CONTINUE
      IF (LLOG) WRITE(6,*)'  List - Points',N1,' to ',NP, ' Set=',ISET,'
     * Name=','"'//C_NAME(:N_NAME)//'"'
      IF (.not.LCOMP) WRITE(LUN,*)' (Data - Points',N1,' to ',NP,' Set',
     *ISET,')'
      LZ=DATBUF(I3).ne.HNONE
      INDEP=2
      IF (LZ.and.FLAGS(56)) THEN
      IDEP=N_ZDATA
      ELSE
      IDEP=N_YDATA
      ENDIF
      IF(LVALU) THEN
      WRITE(OUTSTR,'(A,2A7,(12A15))')  ' SET ORDER DUM',(CORDER(IVARBL(I
     *)),I=1,NINCR)
      CALL T2WRSQ(OUTSTR,LCOMP,LUN,1)
      ENDIF
      ZMIN=1.0E35
      ZMAX=-1.0E35
      SYM=' '
      OUTSTR=' DATA SET NAME="'//C_NAME(:N_NAME)//'"'
      CALL T2WRSQ(OUTSTR,LCOMP,LUN,1)
      WRITE(OUTSTR,*)' (Set number -',ISET,')'
      CALL T2WRSQ(OUTSTR,LCOMP,LUN,1)
      DO 12001 I=N1,NP
      IF(LTRAP) GOTO 11960
      SETNUM=0
      DO 12011 J=1,NINCR
      DVEC(IVARBL(J))=DATBUF(IM)
      IM=IM+1
12011 CONTINUE
12012 CONTINUE
      SYM=T2_GET_SYMBOL(DVEC(N_SYMBOL))
      DO 12021 J=1,JLIM
      TEMP=DVEC(NCSIZE*(J-1)+N_XDATA)
      IF (TEMP.lt.TLIM(J,1) .or. TEMP.gt.TLIM(J,2) ) GOTO 12030
12021 CONTINUE
12022 CONTINUE
      IF(LSTAT) THEN
      SUM(8)=SUM(8)+1.
      TEMP=DVEC(IDEP)
      SUM(1)=SUM(1)+TEMP
      IF(TEMP.lt.ZMIN)ZMIN=TEMP
      IF(TEMP.gt.ZMAX)ZMAX=TEMP
      TEMP1=DVEC(INDEP)
      DO 12041 J=1,3
      SUM(J+1)=  SUM(J+1)+TEMP*TEMP1**J
12041 CONTINUE
12042 CONTINUE
      IF(LVALU) THEN
      WRITE(OUTSTR,'(1x,I7,1x,A4,2x,1p,(8G15.6))')  I,SYM,(DVEC(IVARBL(J
     *)),J=2,NINCR)
      CALL T2WRSQ(OUTSTR,LCOMP,LUN,1)
      ENDIF
      ENDIF
12030 CONTINUE
12001 CONTINUE
12002 CONTINUE
      ENDIF
      IF (SUM(8).gt.0) THEN
      WRITE(LUN,'(1p,5(A,1p,G15.6))')' (Pts= ',SUM(8),')'
      WRITE(LUN,'(2A,1p,5(A,1p,G15.6))')  ' (',CORDER(IDEP), ' Sum= ',SU
     *M(1), ' Ave= ',SUM(1)/SUM(8),' /Point)'
      IF (SUM(1).ne.0.0.and.IBTYPE.eq.1) THEN
      DTEMP1=SUM(3)/SUM(1)-(SUM(2)/SUM(1))**2
      DTEMP1=SQRT(ABS(DTEMP1))
      WRITE(LUN,'(2A,1p,5(A,1p,G15.6))')  ' (',CORDER(INDEP), ' Mean=',S
     *UM(2)/SUM(1), ' Std= ',DTEMP1,')'
      ENDIF
      WRITE(LUN,'(2A,1p,5(A,1p,G15.6))')  ' (',CORDER(IDEP), ' Min= ',ZM
     *IN,' Max= ',ZMAX,')'
      ENDIF
11921 CONTINUE
11922 CONTINUE
11960 CONTINUE
      IF (LLOG) THEN
      N_FILE=0
      INQUIRE(UNIT=LUN,NAME=C_FILE,ERR=12050)
      CALL T2_CONCEAL_PASSWORD(C_FILE,N_FILE)
      if (C_ACCESS(1:1) .eq. 'S') C_ACCESS='written'
      WRITE(6,*)'        ',C_ACCESS,' To:',C_FILE(:N_FILE)
      ENDIF
      IF (LTRAP) WRITE(6,*) '*** Listing terminated'
12050 CONTINUE
      IF (LUN.eq.1) CLOSE(UNIT=LUN)
      RETURN
11910 CONTINUE
      CALL T2ERR(INFOIN,CARDIN,('*** ERROR *** Failure to open list file
     *:'//C_FILE(:N_FILE)),4)
      END
      SUBROUTINE T2_SHOW_ALL
      IMPLICIT NONE
      INTEGER T2_SHOW1
      INTEGER INFOIN(10),I
      DO 12061 I=1,10
      INFOIN(I)=0
12061 CONTINUE
12062 CONTINUE
      I=T2_SHOW1(INFOIN,'VERSION,ARROW,AXIS,BAR,BOX,BLINK'  //',CARD,CHA
     *RACTERS,CLEAR,COLOR,CTRL,CYCLE'  //',DATA BRIEF,DATE,DEVICE,DIAMON
     *D,DIGITS'  //',ELLIPSE,ERRORS,FIT,FILE,FILL,FLUSH,FONT,FORMAT'  //
     *',GRID,INTENSITY,KEYS,LABELS,LIMITS,MODE,MONITOR,ORDER,OUTLINE'  /
     */',PATTERN,PAUSE,PEN,PLOTS,POLAR,PRIMARY,REVISION'  //',SECONDARY,
     *SEGMENTS,SCALE,SHADOW,SHIELD,SIZE,STORAGE,SYMBOL'  //',TEXTURE,THR
     *EE,TICKS,TIME,TITLE'  //',UNITS,WINDOW')
      END
      SUBROUTINE T2_SHOW_AXIS(IFL1,IFL2)
      IMPLICIT NONE
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      LOGICAL DFLAGS(200),DSCREV(3)
      COMMON /T2FLGD/DFLAGS,DSCREV
      REAL DTITLIN(4), DTITFAC(4), DTITMAR(4)
      INTEGER DGRDTYP, DGRDTEX, DOUTTEX, IDAXTEX, DTITEX, DSHADOWTYP,DS
     *HADOWTEX, IFLDDF(19), NDDIMNS, IDTXPRI, IDTXSEC, LINCLF, LINTXF,
     * LINWDF, DNONLN(3), DNXYZ1(3), DNXYZ2(3), DLABTEX, DTICTEX, DNPAT
     *RN(30), DLBLCHR(3), ND_CYCLE, IDTX_CYCLE(MAX_CYCLE)
      REAL DSYM_CYCLE(MAX_CYCLE)
      REAL DTITSIZ, DGRDSYM, DGRDSIZ, DCIRSIZ(2,3), DASIZE, DAFLARE, D
     *SMSZDF, DORAXES(3), DEYEDIR(3), DVUEDIR(3), DVUECEN(3), DVERTCL(3
     *), DEYESEP, DSCRD, DSCRZ, DEYEDIS, DEYEPNT(3), DBARSIZ(3), DBARBR
     *K(3), DTIKSIZ(3), DXYZBS(3), DTTHETA, DTPHI, DFRELBL(4), DPATRN(2
     *0,30), DSCLPRM(10,3), DWINDOW(4), DSCREEN(2), DSYMBOL, DNOSYMB, 
     *DAXANG(3), DLBLSIZ, DSYMSIZ, DXYZLIM(3,2), DFACTXY(19), DRADANG,
     * DDSCAL, DPATSZ, DTITINX, DTIKFAC, DSYDIR(3), DGRDIR(3)
      COMMON /T2COMD/ DTITSIZ, DGRDSYM, DGRDSIZ, DCIRSIZ, DASIZE, DAFLA
     *RE, DSMSZDF, DORAXES, DEYEDIR, DVUEDIR, DVUECEN, DVERTCL, DEYESE
     *P, DSCRD, DSCRZ, DEYEDIS, DEYEPNT, DBARSIZ, DTIKSIZ, DXYZBS, DTTH
     *ETA, DTPHI, DFRELBL, DNPATRN, DPATRN, DSCLPRM, DWINDOW, DSCREEN,
     * DSYMBOL, DNOSYMB, DAXANG, DLBLSIZ, DSYMSIZ, DXYZLIM, DGRDTYP, D
     *FACTXY, IFLDDF, NDDIMNS, DGRDTEX, DOUTTEX, IDAXTEX, DTITEX, DRADA
     *NG, DDSCAL, DNONLN, DNXYZ1, DNXYZ2, LINCLF, LINTXF, LINWDF, DLABT
     *EX, DTICTEX, DPATSZ, IDTXPRI, IDTXSEC, DTITLIN, DTITINX, DLBLCHR,
     * DTITFAC, DTITMAR, DTIKFAC, DSYDIR, DGRDIR, ND_CYCLE, IDTX_CYCLE,
     * DSYM_CYCLE, DBARBRK,  DSHADOWTYP,DSHADOWTEX
      CHARACTER*10 ONOFF(2)
      INTEGER IFL,IFL1,IFL2,I,J,IONOFF(4,2),IPASS,IMAX
      DATA ONOFF/'ON','OFF'/
      DO 12071 IPASS=1,2
      IF (IPASS.eq.1) THEN
      IMAX=3
      IFL=IFL2-1
      IF(IFL .le. 0)GOTO 12071
      WRITE(6,12080)' ','X','Y','Z'
      ELSE
      IMAX=4
      IFL=IFL1-1
      WRITE(6,12080)' ','Left','Bottom','Right','Top'
      ENDIF
      IF (IFL .le. 0) RETURN
      DO 12091 I=1,2
      DO 12101 J=1,4
      IONOFF(J,I)=2
12101 CONTINUE
12102 CONTINUE
12091 CONTINUE
12092 CONTINUE
      DO 12111 I=1,IMAX
      IF (FLAGS(IFL+I))IONOFF(I,1)=1
      IF (DFLAGS(IFL+I))IONOFF(I,2)=1
12111 CONTINUE
12112 CONTINUE
      WRITE(6,12080)'  Setting=', (ONOFF(IONOFF(I,1)),I=1,IMAX)
      WRITE(6,12080)'    Default:', (ONOFF(IONOFF(I,2)),I=1,IMAX)
12071 CONTINUE
12072 CONTINUE
12080 FORMAT(2X,A,T19,A,T30,A,T41,A,T52,A,T63,A,T74,A)
      END
      SUBROUTINE T2_SHOW_ON_OFF(STR,IFL)
      IMPLICIT NONE
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      LOGICAL DFLAGS(200),DSCREV(3)
      COMMON /T2FLGD/DFLAGS,DSCREV
      REAL DTITLIN(4), DTITFAC(4), DTITMAR(4)
      INTEGER DGRDTYP, DGRDTEX, DOUTTEX, IDAXTEX, DTITEX, DSHADOWTYP,DS
     *HADOWTEX, IFLDDF(19), NDDIMNS, IDTXPRI, IDTXSEC, LINCLF, LINTXF,
     * LINWDF, DNONLN(3), DNXYZ1(3), DNXYZ2(3), DLABTEX, DTICTEX, DNPAT
     *RN(30), DLBLCHR(3), ND_CYCLE, IDTX_CYCLE(MAX_CYCLE)
      REAL DSYM_CYCLE(MAX_CYCLE)
      REAL DTITSIZ, DGRDSYM, DGRDSIZ, DCIRSIZ(2,3), DASIZE, DAFLARE, D
     *SMSZDF, DORAXES(3), DEYEDIR(3), DVUEDIR(3), DVUECEN(3), DVERTCL(3
     *), DEYESEP, DSCRD, DSCRZ, DEYEDIS, DEYEPNT(3), DBARSIZ(3), DBARBR
     *K(3), DTIKSIZ(3), DXYZBS(3), DTTHETA, DTPHI, DFRELBL(4), DPATRN(2
     *0,30), DSCLPRM(10,3), DWINDOW(4), DSCREEN(2), DSYMBOL, DNOSYMB, 
     *DAXANG(3), DLBLSIZ, DSYMSIZ, DXYZLIM(3,2), DFACTXY(19), DRADANG,
     * DDSCAL, DPATSZ, DTITINX, DTIKFAC, DSYDIR(3), DGRDIR(3)
      COMMON /T2COMD/ DTITSIZ, DGRDSYM, DGRDSIZ, DCIRSIZ, DASIZE, DAFLA
     *RE, DSMSZDF, DORAXES, DEYEDIR, DVUEDIR, DVUECEN, DVERTCL, DEYESE
     *P, DSCRD, DSCRZ, DEYEDIS, DEYEPNT, DBARSIZ, DTIKSIZ, DXYZBS, DTTH
     *ETA, DTPHI, DFRELBL, DNPATRN, DPATRN, DSCLPRM, DWINDOW, DSCREEN,
     * DSYMBOL, DNOSYMB, DAXANG, DLBLSIZ, DSYMSIZ, DXYZLIM, DGRDTYP, D
     *FACTXY, IFLDDF, NDDIMNS, DGRDTEX, DOUTTEX, IDAXTEX, DTITEX, DRADA
     *NG, DDSCAL, DNONLN, DNXYZ1, DNXYZ2, LINCLF, LINTXF, LINWDF, DLABT
     *EX, DTICTEX, DPATSZ, IDTXPRI, IDTXSEC, DTITLIN, DTITINX, DLBLCHR,
     * DTITFAC, DTITMAR, DTIKFAC, DSYDIR, DGRDIR, ND_CYCLE, IDTX_CYCLE,
     * DSYM_CYCLE, DBARBRK,  DSHADOWTYP,DSHADOWTEX
      CHARACTER*(*) STR
      CHARACTER*4 ONOFF(2)
      INTEGER IFL,I,J,K
      DATA ONOFF/'ON','OFF'/
      I=ABS(IFL)
      J=2
      K=2
      IF (FLAGS(I) ) J=1
      IF (DFLAGS(I)) K=1
      IF (IFL.gt.0) THEN
      WRITE(6,12120)STR,ONOFF(J),ONOFF(K)
      ELSE
      WRITE(6,12130)STR,ONOFF(J)
      ENDIF
12130 FORMAT(2X,A,T19,A)
12120 FORMAT(2X,A,T19,A,T30,'Default:',T41,A)
      END
      SUBROUTINE T2_SHOW_INHIBIT(IFL)
      IMPLICIT NONE
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      LOGICAL DFLAGS(200),DSCREV(3)
      COMMON /T2FLGD/DFLAGS,DSCREV
      REAL DTITLIN(4), DTITFAC(4), DTITMAR(4)
      INTEGER DGRDTYP, DGRDTEX, DOUTTEX, IDAXTEX, DTITEX, DSHADOWTYP,DS
     *HADOWTEX, IFLDDF(19), NDDIMNS, IDTXPRI, IDTXSEC, LINCLF, LINTXF,
     * LINWDF, DNONLN(3), DNXYZ1(3), DNXYZ2(3), DLABTEX, DTICTEX, DNPAT
     *RN(30), DLBLCHR(3), ND_CYCLE, IDTX_CYCLE(MAX_CYCLE)
      REAL DSYM_CYCLE(MAX_CYCLE)
      REAL DTITSIZ, DGRDSYM, DGRDSIZ, DCIRSIZ(2,3), DASIZE, DAFLARE, D
     *SMSZDF, DORAXES(3), DEYEDIR(3), DVUEDIR(3), DVUECEN(3), DVERTCL(3
     *), DEYESEP, DSCRD, DSCRZ, DEYEDIS, DEYEPNT(3), DBARSIZ(3), DBARBR
     *K(3), DTIKSIZ(3), DXYZBS(3), DTTHETA, DTPHI, DFRELBL(4), DPATRN(2
     *0,30), DSCLPRM(10,3), DWINDOW(4), DSCREEN(2), DSYMBOL, DNOSYMB, 
     *DAXANG(3), DLBLSIZ, DSYMSIZ, DXYZLIM(3,2), DFACTXY(19), DRADANG,
     * DDSCAL, DPATSZ, DTITINX, DTIKFAC, DSYDIR(3), DGRDIR(3)
      COMMON /T2COMD/ DTITSIZ, DGRDSYM, DGRDSIZ, DCIRSIZ, DASIZE, DAFLA
     *RE, DSMSZDF, DORAXES, DEYEDIR, DVUEDIR, DVUECEN, DVERTCL, DEYESE
     *P, DSCRD, DSCRZ, DEYEDIS, DEYEPNT, DBARSIZ, DTIKSIZ, DXYZBS, DTTH
     *ETA, DTPHI, DFRELBL, DNPATRN, DPATRN, DSCLPRM, DWINDOW, DSCREEN,
     * DSYMBOL, DNOSYMB, DAXANG, DLBLSIZ, DSYMSIZ, DXYZLIM, DGRDTYP, D
     *FACTXY, IFLDDF, NDDIMNS, DGRDTEX, DOUTTEX, IDAXTEX, DTITEX, DRADA
     *NG, DDSCAL, DNONLN, DNXYZ1, DNXYZ2, LINCLF, LINTXF, LINWDF, DLABT
     *EX, DTICTEX, DPATSZ, IDTXPRI, IDTXSEC, DTITLIN, DTITINX, DLBLCHR,
     * DTITFAC, DTITMAR, DTIKFAC, DSYDIR, DGRDIR, ND_CYCLE, IDTX_CYCLE,
     * DSYM_CYCLE, DBARBRK,  DSHADOWTYP,DSHADOWTEX
      INTEGER J,K,IFL
      CHARACTER*10 ONOFF(2)
      DATA ONOFF/'ENABLED','INHIBITED'/
      J=1
      K=1
      IF (FLAGS(IFL)) J=2
      IF (DFLAGS(IFL)) K=2
      WRITE(6,'(2X,A,T19,A,T30,A,T41,A)')  '  Auto plot=',ONOFF(J),'Defa
     *ult:',ONOFF(K)
      END
      SUBROUTINE T2_SHOW_TEXTURE(I,K)
      IMPLICIT NONE
      INTEGER I,J,K,L
      INTEGER IAND
      CHARACTER*8 COL(9)
      CHARACTER*10 CTEX(8)
      DATA COL/'NONE','WHITE','RED','GREEN','BLUE','YELLOW','MAGENTA','C
     *YAN','BLACK'/
      DATA CTEX/'NONE','DOTS','DASHES','DOTDASHES', 'SOLID','FUNNY','PAT
     *TERNED','DAASHES'/
      J=IAND(I/8,7)
      L=IAND(K/8,7)
12140 FORMAT(2X,A,T16,I7,T30,'Default:',T38,I7,T52,A)
12150 FORMAT(2X,A,T19,A,T30,'Default:',T41,A)
      WRITE(6,12140)'  Intensity=',J,L
      J=IAND(I/512,7)+1
      L=IAND(K/512,7)+1
      WRITE(6,12150)'  Color=',COL(J),COL(L)
      J=IAND(I/64,7)+1
      L=IAND(K/64,7)+1
      WRITE(6,12150)'  Texture=',CTEX(J),CTEX(L)
      IF (J.eq.7 .or. L.eq.7) CALL T2_SHOW_PATTERN(I)
      END
      SUBROUTINE T2_SHOW_PATTERN(I)
      IMPLICIT NONE
      INTEGER I,J,K
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      INTEGER IAND
      J=IAND(I/64,7)
      IF (J .ne. 6) RETURN
      K=MIN(MAX(I/4096,1),30)
      IF (NPATRN(K).gt.1) THEN
      WRITE(6,'(1X,4(4X,''Draw'',5x,''Space''))')
      WRITE(6,'(4X,1P,8G9.2)')(PATRN(J,K),J=1,NPATRN(K))
      ENDIF
      END
      SUBROUTINE T2_TYPE(INFOIN,CARDIN)
      IMPLICIT NONE
      INTEGER INFOIN(10)
      CHARACTER*(*) CARDIN
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      INTEGER ITEMP,NTSTR
      LOGICAL LATTR
      CHARACTER*100 TSTR
      CHARACTER DIGITS*10
      CHARACTER FB*1
      DATA DIGITS/'0123456789'/
      DATA FB/'3'/
      ITEMP=0
      NTSTR=0
      TSTR=' '
      LATTR=.false.
      FB='3'
      GOTO 12161
12190 CONTINUE
      TSTR(NTSTR+1:LEN(TSTR))=CHAR(27)//'[2J'
      NTSTR=MIN(NTSTR+4,LEN(TSTR))
      GOTO 12161
12200 CONTINUE
      TSTR(NTSTR+1:LEN(TSTR))=CHAR(27)//'[H'//CHAR(27)//'[K'
      NTSTR=MIN(NTSTR+6,LEN(TSTR))
      GOTO 12161
12210 CONTINUE
      TSTR(NTSTR+1:LEN(TSTR))=CHAR(27)//'[50H'//CHAR(27)//'[K'
      NTSTR=MIN(NTSTR+8,LEN(TSTR))
      GOTO 12161
12220 CONTINUE
      NTSTR=MIN(NTSTR+1,LEN(TSTR))
      TSTR(NTSTR:NTSTR) = CHAR(7)
      GOTO 12161
12230 CONTINUE
      TSTR(NTSTR+1:LEN(TSTR))=CHAR(27)//'['//CHAR(INTEG+48)//'m'
      LATTR=.TRUE.
      NTSTR=MIN(NTSTR+4,LEN(TSTR))
      GOTO 12161
12240 CONTINUE
      TSTR(NTSTR+1:LEN(TSTR))=CHAR(27)//'#6'
      NTSTR=MIN(NTSTR+3,LEN(TSTR))
      GOTO 12161
12250 CONTINUE
      INTEG=INTEG+1
      FB=DIGITS(INTEG:INTEG)
      GOTO 12161
12260 CONTINUE
      INTEG=INTEG+1
      TSTR(NTSTR+1:)=CHAR(27)//'['//FB//DIGITS(INTEG:INTEG)//'m'
      NTSTR=MIN(NTSTR+5,LEN(TSTR))
      GOTO 12161
12170 GOTO ( 12190,12200,12210,12220,12230,12230,12230,12230,12240,12250
     *,12250,12260,12260,12260,12260,12260,12260,12260,12260,12165),
     *KEYORD
12270 CONTINUE
      NTSTR=MIN(NTSTR+1,LEN(TSTR))
      TSTR(NTSTR:NTSTR)=CHAR(INTEG)
      GOTO 12161
12280 CONTINUE
      IF(NSTRNG.le.0) THEN
      NSTRNG=1
      STRNG=' '
      ENDIF
      TSTR(NTSTR+1:LEN(TSTR))=STRNG(1:NSTRNG)
      NTSTR=MIN(NTSTR+NSTRNG,LEN(TSTR))
      GOTO 12161
12161 CALL TOKEN(INFOIN,CARDIN,'ERASE,TOP,BOTTOM,BELL,BOLD:1,UNDERLINE:4
     *,BLINK:5,REVERSE:7,WIDE,BACKGROUND:4,FOREGROUND:3,RED:1,GREEN:2,BL
     *UE:4,YELLOW:3,MAGENTA:5,CYAN:6,WHITE:7,BLACK:8;')
      GOTO (12162,12170,12270,12270,12280,12165,12165,12170,12165),INTER
     *P
12165 CALL T2ERR(INFOIN,CARDIN,' ',5)
      GOTO 12161
12162 CONTINUE
      IF (LATTR) THEN
      WRITE(6,*) TSTR(1:NTSTR)//CHAR(27)//'[0m'
      ELSE
      IF (NTSTR.gt.0) WRITE(6,*) TSTR(1:NTSTR)
      ENDIF
      END
      SUBROUTINE TDSTAT(TLIM,N1,N2,N3,N4,NS1,NS2,LWEIGHT,NTLIM,STRING)
      IMPLICIT NONE
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      REAL HNONE
      INTEGER NSETD 
      PARAMETER (NSETD=19+9)
      INTEGER ISETD(NSETD),NINCR0,NINCR1,NINCR2,IBTYPE
      INTEGER I1,I2,I3,I4,I5,I6,I7,IM,NP,NL,IENDAT,IBGDAT
      INTEGER I_NDX,I_NDY,I_NDZ
      INTEGER N_SYMBOL 
      INTEGER N_XDATA 
      INTEGER N_DXDATA 
      INTEGER N_NDXDATA 
      INTEGER N_YDATA 
      INTEGER N_DYDATA 
      INTEGER N_NDYDATA 
      INTEGER N_ZDATA 
      INTEGER N_DZDATA 
      INTEGER N_NDZDATA 
      INTEGER N_UDATA 
      INTEGER N_DUDATA 
      INTEGER N_NDUDATA 
      INTEGER N_VDATA 
      INTEGER N_DVDATA 
      INTEGER N_NDVDATA 
      INTEGER N_WDATA 
      INTEGER N_DWDATA 
      INTEGER N_NDWDATA 
      INTEGER NCMAX 
      INTEGER NCSIZE 
      INTEGER NBTYPE 
      INTEGER NINDAT 
      INTEGER NSDATA 
      INTEGER NXDATA 
      INTEGER NDXDATA 
      INTEGER NNDXDATA 
      INTEGER NYDATA 
      INTEGER NDYDATA 
      INTEGER NNDYDATA 
      INTEGER NZDATA 
      INTEGER NDZDATA 
      INTEGER NNDZDATA 
      INTEGER NPDATA 
      INTEGER NLDATA 
      INTEGER NMDATA 
      INTEGER NBGDAT 
      INTEGER NENDAT 
      PARAMETER (N_SYMBOL=1) 
      PARAMETER (N_XDATA=2) 
      PARAMETER (N_DXDATA=3) 
      PARAMETER (N_NDXDATA=4) 
      PARAMETER (N_YDATA=5) 
      PARAMETER (N_DYDATA=6) 
      PARAMETER (N_NDYDATA=7) 
      PARAMETER (N_ZDATA=8) 
      PARAMETER (N_DZDATA=9) 
      PARAMETER (N_NDZDATA=10) 
      PARAMETER (N_UDATA=11) 
      PARAMETER (N_DUDATA=12) 
      PARAMETER (N_NDUDATA=13) 
      PARAMETER (N_VDATA=14) 
      PARAMETER (N_DVDATA=15) 
      PARAMETER (N_NDVDATA=16) 
      PARAMETER (N_WDATA=17) 
      PARAMETER (N_DWDATA=18) 
      PARAMETER (N_NDWDATA=19) 
      PARAMETER (NCMAX=6) 
      PARAMETER (NCSIZE=3) 
      PARAMETER (NBTYPE=1) 
      PARAMETER (NINDAT=2) 
      PARAMETER (NSDATA=5) 
      PARAMETER (NXDATA=NSDATA+1) 
      PARAMETER (NDXDATA=NXDATA+1) 
      PARAMETER (NNDXDATA=NXDATA+2) 
      PARAMETER (NYDATA=NXDATA+NCSIZE) 
      PARAMETER (NDYDATA=NYDATA+1) 
      PARAMETER (NNDYDATA=NYDATA+2) 
      PARAMETER (NZDATA=NYDATA+NCSIZE) 
      PARAMETER (NDZDATA=NZDATA+1) 
      PARAMETER (NNDZDATA=NZDATA+2) 
      PARAMETER (NPDATA=NSDATA+19) 
      PARAMETER (NLDATA=NPDATA+1) 
      PARAMETER (NMDATA=NLDATA+1) 
      PARAMETER (NBGDAT=NMDATA+1) 
      PARAMETER (NENDAT=NBGDAT+1) 
      EQUIVALENCE (IBTYPE,ISETD(NBTYPE))
      EQUIVALENCE (NINCR0,ISETD(NINDAT))
      EQUIVALENCE (NINCR1,ISETD(NINDAT+1))
      EQUIVALENCE (NINCR2,ISETD(NINDAT+2))
      EQUIVALENCE (I7,ISETD(NSDATA))
      EQUIVALENCE (I1,ISETD(NXDATA))
      EQUIVALENCE (I4,ISETD(NDXDATA))
      EQUIVALENCE (I2,ISETD(NYDATA))
      EQUIVALENCE (I5,ISETD(NDYDATA))
      EQUIVALENCE (I3,ISETD(NZDATA))
      EQUIVALENCE (I6,ISETD(NDZDATA))
      EQUIVALENCE (I_NDX,ISETD(NNDXDATA))
      EQUIVALENCE (I_NDY,ISETD(NNDYDATA))
      EQUIVALENCE (I_NDZ,ISETD(NNDZDATA))
      EQUIVALENCE (NP,ISETD(NPDATA))
      EQUIVALENCE (NL,ISETD(NLDATA))
      EQUIVALENCE (IM,ISETD(NMDATA))
      EQUIVALENCE (IBGDAT,ISETD(NBGDAT))
      EQUIVALENCE (IENDAT,ISETD(NENDAT))
      INTEGER LISTPT,NPTMAX,NDSETS
      REAL DATBUF(10248)
      COMMON /T2XPNT/ LISTPT,NPTMAX,NDSETS,DATBUF
      LOGICAL LWEIGHT, LOK
      REAL TLIM(3,*),DLIM(3,2),XYZ(19),XFAC,YFAC,ZFAC,TEMP1, TEMP2, TEMP
     *3
      REAL T,TLIM1(3,2)
      DOUBLE PRECISION DSUM(8),DERR(8,4)
      DOUBLE PRECISION DDSLOPE(2,2,2)
      INTEGER NTLIM
      CHARACTER*(*) STRING
      INTEGER I,J,JLIM,K,KLIM,L,LLIM
      INTEGER IS,IDEP,IZYZ(19),ISET,N1,N2,N3,N4,NS1,NS2
      DATA HNONE /-666.666/
      DO 12291 J=1,8
      DSUM(J)=0.0
12291 CONTINUE
12292 CONTINUE
      DO 12301 J=1,4
      DO 12311 K=1,8
      DERR(K,J)=0.0
12311 CONTINUE
12312 CONTINUE
12301 CONTINUE
12302 CONTINUE
      DO 12321 J=1,8
      DO 12331 I=1,2
      DATDAT(I,J)=0
12331 CONTINUE
12332 CONTINUE
12321 CONTINUE
12322 CONTINUE
      DO 12341 K=1,2
      DO 12351 J=1,2
      DO 12361 I=1,2
      DDSLOPE(I,J,K)=0
12361 CONTINUE
12362 CONTINUE
12351 CONTINUE
12352 CONTINUE
12341 CONTINUE
12342 CONTINUE
      DATXMN=1.0E35
      DATXMX=-1.0E35
      DATYMN=1.0E35
      DATYMX=-1.0E35
      DATZMN=1.0E35
      DATZMX=-1.0E35
      CALL T2DTLM(TLIM,N1,N2,N3,N4,NS1,NS2,XFAC,YFAC,ZFAC,DLIM, NTLIM,ST
     *RING)
      KLIM=NTLIM
      IF (TLIM(1,1) .eq. HNONE) KLIM=-5
      TLIM1(1,1)=HNONE
      IF (KLIM .gt. 1) THEN
C      DO 12371 J=1,2
      DO 12381 I=1,3
      TLIM1(I,1)=MIN(DLIM(I,1),TLIM(I,1))
      TLIM1(I,2)=MAX(DLIM(I,2),TLIM(I,2))
12381 CONTINUE
12382 CONTINUE
C 12371 CONTINUE
12372 CONTINUE
      ENDIF
      DO 12391 ISET=NS1,NS2
      JLIM=2
      IDEP=N_YDATA
      DO 12401 I=1,19
      XYZ(I)=0
12401 CONTINUE
12402 CONTINUE
      CALL T2GDSET(ISET,N1,N2,N3,N4,ISETD,TLIM1,STRING)
      IF(NP .lt. N1)GOTO 12391
      IF (DATBUF(I3).ne.HNONE) THEN
      JLIM=3
      IF (FLAGS(56)) THEN
      IDEP=N_ZDATA
      YFAC=ZFAC
      ENDIF
      ENDIF
      K=0
      IF (NP.ge.N1 .and. NL.ge.N3) THEN
      IF (IBTYPE.eq.2 ) THEN
      NP=NMESH0*(NP-N1+1)-1
      DO 12411 I=N3,NL
      IF (LTRAP) GOTO 12420
      XYZ(MESH2*2)=DATBUF(I2)
      IF (NMESH0.eq.2) XYZ(MESH2*2)=DATBUF(I2+1)
      DO 12431 J=0,NP,NMESH0
      IF (LTRAP) GOTO 12420
      XYZ(MESH1*2)=DATBUF(I1+J)
      XYZ(MESH3*2)=DATBUF(I3+J)
      IF (KLIM .gt. 0) THEN
      DO 12441 K=1,KLIM,2
      DO 12451 L=1,JLIM
      IF(XYZ(L) .lt. TLIM(L,K) .or. XYZ(L) .gt. TLIM(L,K+1))GOTO 12452
12451 CONTINUE
12452 CONTINUE
      IF(L .gt. JLIM)GOTO 12442
12441 CONTINUE
12442 CONTINUE
      IF(K .gt. KLIM)GOTO 12431
      ENDIF
      CALL T2DTSM(XYZ(2),XYZ(6), XYZ(3),XYZ(7), DSUM,DERR,LWEIGHT)
      DO 12461 K=1,2
      DO 12471 L=1,2
      IF (ABS(XYZ(2*L)-DLIM(K,L)) .lt. (DLIM(K,2)-DLIM(K,1))/10) THEN
      DDSLOPE(K,L,1)=DDSLOPE(K,L,1)+1
      DDSLOPE(K,L,1)=DDSLOPE(K,L,1)+XYZ(6)
      ENDIF
12471 CONTINUE
12472 CONTINUE
12461 CONTINUE
12462 CONTINUE
12431 CONTINUE
12432 CONTINUE
      I2=I2+NINCR1*NINCR0
      I3=I3+NINCR1*NINCR0
12411 CONTINUE
12412 CONTINUE
      ELSEIF (IBTYPE.eq.1) THEN
      DO 12481 I=N1,NP
      IF (LTRAP) GOTO 12420
      DO 12491 J=1,NINCR
      XYZ(IVARBL(J))=DATBUF(IM)
      IM=IM+1
12491 CONTINUE
12492 CONTINUE
      IF (KLIM .gt. 0) THEN
      DO 12501 K=1,KLIM,2
      DO 12511 J=1,JLIM
      IF(XYZ(NCSIZE*(J-1)+N_XDATA).lt.TLIM(J,K) .or. XYZ(NCSIZE*(J-1)+N_
     *XDATA).gt.TLIM(J,K+1))GOTO 12511
12511 CONTINUE
12512 CONTINUE
      IF(J .gt. JLIM)GOTO 12502
12501 CONTINUE
12502 CONTINUE
      IF(K .gt. KLIM)GOTO 12481
      ENDIF
      CALL T2DTSM(XYZ(N_XDATA),XYZ(IDEP), XYZ(N_DXDATA),XYZ(IDEP+1),DSUM
     *,DERR,LWEIGHT)
      DO 12521 K=1,2
      DO 12531 L=1,2
      IF (ABS(XYZ(NCSIZE*(L-1)+N_XDATA)-DLIM(K,L)) .lt. (DLIM(K,2)-DLIM(
     *K,1))/10) THEN
      DDSLOPE(K,L,1)=DDSLOPE(K,L,1)+1
      DDSLOPE(K,L,1)=DDSLOPE(K,L,1)+XYZ(IDEP)
      ENDIF
12531 CONTINUE
12532 CONTINUE
12521 CONTINUE
12522 CONTINUE
12481 CONTINUE
12482 CONTINUE
      ENDIF
      ENDIF
12391 CONTINUE
12392 CONTINUE
      DATXMN=DLIM(1,1)
      DATXMX=DLIM(1,2)
      DATYMN=DLIM(2,1)
      DATYMX=DLIM(2,2)
      DATZMN=DLIM(3,1)
      DATZMX=DLIM(3,2)
      CALL T2STSM(XFAC,YFAC,DSUM,DERR,LWEIGHT)
      DO 12541 I=1,2
      DO 12551 J=1,2
      DSLOPE(J,I)=HNONE
      IF (DDSLOPE(J,I,1) .gt. 0) DSLOPE(J,I)=DDSLOPE(J,I,2)/DDSLOPE(J,I,
     *1)
12551 CONTINUE
12552 CONTINUE
12541 CONTINUE
12542 CONTINUE
12420 CONTINUE
      END
      SUBROUTINE T2STSM(XFAC,YFAC,DSUM,DERR,LWEIGHT)
      IMPLICIT NONE
      LOGICAL LWEIGHT
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      REAL XFAC,YFAC
      DOUBLE PRECISION DSUM(8),DTEMP1,DTEMP2,DTEMP3,DERR(8,4),DERRSTD,DE
     *RRCEN
      IF (DSUM(8).gt.0.and.XFAC.ne.0.and.YFAC.ne.0) THEN
      DATPTS=DSUM(8)
      DATSUM=DSUM(1)/YFAC
      DATAVE=DATSUM/DSUM(8)
      ERRSUM=SQRT(DERR(1,1))/YFAC
      ERRAVE=(ERRSUM/DSUM(8))
      ERRSTD=0
      ERRCEN=0
      IF (DATSUM.ne.0.0) THEN
      DTEMP1=DSUM(2)/DSUM(1)
      DATCEN=DTEMP1/XFAC
      DTEMP2=DSUM(3)/DSUM(1)-DTEMP1**2
      DATSTD=SQRT(ABS(DTEMP2))/XFAC
      IF (DERR(1,1).gt.0 .or. DERR(1,2).gt.0) THEN
      IF (DERR(1,2) .ne. 0 .and. (DATSTD.le. ABS(0.0000002*DATCEN) .or. 
     *DERR(1,1).eq.0 .or. DSUM(7).lt.3) ) THEN
      DERRCEN=DERR(1,2)
      DERRSTD=4*(DERR(3,2)-2*DERR(2,2)*DSUM(2)+  DERR(1,2)*DSUM(2)**2)
      ELSE
      DERRCEN=DERR(3,1)-2*DERR(2,1)*DTEMP1+DERR(1,1)*DTEMP1**2
      DTEMP2=-2*DTEMP1
      DTEMP3=2*DTEMP1**2-DSUM(3)/DSUM(1)
      DERRSTD=DERR(5,1)+2*DTEMP2*DERR(4,1)+2*DTEMP3*DERR(3,1)  +DTEMP2**
     *2*DERR(3,1)+2*DTEMP2*DTEMP3*DERR(2,1)  +DTEMP3**2*DERR(1,1)
      ENDIF
      ERRCEN=(SQRT(ABS(DERRCEN))/ABS(DSUM(1)))/XFAC
      IF (DATSTD.GT.0) THEN
      DERRSTD=SQRT(ABS(DERRSTD))/ABS(DSUM(1))
      DERRSTD=DERRSTD/XFAC**2
      ERRSTD=0.5*DERRSTD/DATSTD
      ENDIF
      ENDIF
      ENDIF
      ENDIF
      END
      SUBROUTINE T2DTLM(TLIM,N1,N2,N3,N4,NS1,NS2,XFAC,YFAC,ZFAC,DLIM,NTL
     *IM,STRING)
      IMPLICIT NONE
      CHARACTER*(*) STRING
      INTEGER N1,N2,N3,N4,NS1,NS2,NTLIM
      REAL TLIM(3,*),TLIM1(3,2),DLIM(3,2),XFAC,YFAC,ZFAC
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      REAL HNONE
      INTEGER LISTPT,NPTMAX,NDSETS
      REAL DATBUF(10248)
      COMMON /T2XPNT/ LISTPT,NPTMAX,NDSETS,DATBUF
      INTEGER NSETD 
      PARAMETER (NSETD=19+9)
      INTEGER ISETD(NSETD),NINCR0,NINCR1,NINCR2,IBTYPE
      INTEGER I1,I2,I3,I4,I5,I6,I7,IM,NP,NL,IENDAT,IBGDAT
      INTEGER I_NDX,I_NDY,I_NDZ
      INTEGER N_SYMBOL 
      INTEGER N_XDATA 
      INTEGER N_DXDATA 
      INTEGER N_NDXDATA 
      INTEGER N_YDATA 
      INTEGER N_DYDATA 
      INTEGER N_NDYDATA 
      INTEGER N_ZDATA 
      INTEGER N_DZDATA 
      INTEGER N_NDZDATA 
      INTEGER N_UDATA 
      INTEGER N_DUDATA 
      INTEGER N_NDUDATA 
      INTEGER N_VDATA 
      INTEGER N_DVDATA 
      INTEGER N_NDVDATA 
      INTEGER N_WDATA 
      INTEGER N_DWDATA 
      INTEGER N_NDWDATA 
      INTEGER NCMAX 
      INTEGER NCSIZE 
      INTEGER NBTYPE 
      INTEGER NINDAT 
      INTEGER NSDATA 
      INTEGER NXDATA 
      INTEGER NDXDATA 
      INTEGER NNDXDATA 
      INTEGER NYDATA 
      INTEGER NDYDATA 
      INTEGER NNDYDATA 
      INTEGER NZDATA 
      INTEGER NDZDATA 
      INTEGER NNDZDATA 
      INTEGER NPDATA 
      INTEGER NLDATA 
      INTEGER NMDATA 
      INTEGER NBGDAT 
      INTEGER NENDAT 
      PARAMETER (N_SYMBOL=1) 
      PARAMETER (N_XDATA=2) 
      PARAMETER (N_DXDATA=3) 
      PARAMETER (N_NDXDATA=4) 
      PARAMETER (N_YDATA=5) 
      PARAMETER (N_DYDATA=6) 
      PARAMETER (N_NDYDATA=7) 
      PARAMETER (N_ZDATA=8) 
      PARAMETER (N_DZDATA=9) 
      PARAMETER (N_NDZDATA=10) 
      PARAMETER (N_UDATA=11) 
      PARAMETER (N_DUDATA=12) 
      PARAMETER (N_NDUDATA=13) 
      PARAMETER (N_VDATA=14) 
      PARAMETER (N_DVDATA=15) 
      PARAMETER (N_NDVDATA=16) 
      PARAMETER (N_WDATA=17) 
      PARAMETER (N_DWDATA=18) 
      PARAMETER (N_NDWDATA=19) 
      PARAMETER (NCMAX=6) 
      PARAMETER (NCSIZE=3) 
      PARAMETER (NBTYPE=1) 
      PARAMETER (NINDAT=2) 
      PARAMETER (NSDATA=5) 
      PARAMETER (NXDATA=NSDATA+1) 
      PARAMETER (NDXDATA=NXDATA+1) 
      PARAMETER (NNDXDATA=NXDATA+2) 
      PARAMETER (NYDATA=NXDATA+NCSIZE) 
      PARAMETER (NDYDATA=NYDATA+1) 
      PARAMETER (NNDYDATA=NYDATA+2) 
      PARAMETER (NZDATA=NYDATA+NCSIZE) 
      PARAMETER (NDZDATA=NZDATA+1) 
      PARAMETER (NNDZDATA=NZDATA+2) 
      PARAMETER (NPDATA=NSDATA+19) 
      PARAMETER (NLDATA=NPDATA+1) 
      PARAMETER (NMDATA=NLDATA+1) 
      PARAMETER (NBGDAT=NMDATA+1) 
      PARAMETER (NENDAT=NBGDAT+1) 
      EQUIVALENCE (IBTYPE,ISETD(NBTYPE))
      EQUIVALENCE (NINCR0,ISETD(NINDAT))
      EQUIVALENCE (NINCR1,ISETD(NINDAT+1))
      EQUIVALENCE (NINCR2,ISETD(NINDAT+2))
      EQUIVALENCE (I7,ISETD(NSDATA))
      EQUIVALENCE (I1,ISETD(NXDATA))
      EQUIVALENCE (I4,ISETD(NDXDATA))
      EQUIVALENCE (I2,ISETD(NYDATA))
      EQUIVALENCE (I5,ISETD(NDYDATA))
      EQUIVALENCE (I3,ISETD(NZDATA))
      EQUIVALENCE (I6,ISETD(NDZDATA))
      EQUIVALENCE (I_NDX,ISETD(NNDXDATA))
      EQUIVALENCE (I_NDY,ISETD(NNDYDATA))
      EQUIVALENCE (I_NDZ,ISETD(NNDZDATA))
      EQUIVALENCE (NP,ISETD(NPDATA))
      EQUIVALENCE (NL,ISETD(NLDATA))
      EQUIVALENCE (IM,ISETD(NMDATA))
      EQUIVALENCE (IBGDAT,ISETD(NBGDAT))
      EQUIVALENCE (IENDAT,ISETD(NENDAT))
      REAL XYZ(19),XMIN,YMIN,ZMIN
      INTEGER IS,IDEP,ISET,IPNT,I,J,K,L,LLIM,KLIM
      REAL T
      DATA HNONE /-666.666/
      DO 12561 J=1,3
      DLIM(J,2)=-1.0E35
      DLIM(J,1)=1.0E35
12561 CONTINUE
12562 CONTINUE
      XFAC=1
      YFAC=1
      ZFAC=1
      KLIM=NTLIM
      IF (TLIM(1,1).eq.HNONE) KLIM=0
      TLIM1(1,1)=HNONE
      DO 12571 J=1,2
      DO 12581 I=1,3
      TLIM1(I,J)=TLIM(I,J)
12581 CONTINUE
12582 CONTINUE
12571 CONTINUE
12572 CONTINUE
      DO 12591 J=1,KLIM,2
      DO 12601 I=1,3
      TLIM1(I,1)=MIN(TLIM1(I,1),TLIM(I,J))
      TLIM1(I,2)=MAX(TLIM1(I,2),TLIM(I,J+1))
12601 CONTINUE
12602 CONTINUE
12591 CONTINUE
12592 CONTINUE
      DO 12611 ISET=NS1,NS2
      CALL T2GDSET(ISET,N1,N2,N3,N4,ISETD,TLIM1,STRING)
      IF(NP .lt. N1)GOTO 12611
      IF (DATBUF(I3).eq.HNONE) THEN
      LLIM=2
      ELSE
      LLIM=3
      ENDIF
      IF (NP .ge. N1 .and. NL.ge.N3) THEN
      IF (IBTYPE.eq.2 ) THEN
      NP=(NP-N1+1)*NINCR0-1
      DO 12621 I=N3,NL
      XYZ(MESH2)=DATBUF(I2)
      IPNT=I3
      DO 12631 J=0,NP,NINCR0
      XYZ(MESH1)=DATBUF(I1+J)
      XYZ(MESH3)=DATBUF(I3+J)
      IF (KLIM .gt. 0) THEN
      DO 12641 K=1,KLIM,2
      DO 12651 L=1,LLIM
      IF(XYZ(L) .lt. TLIM(L,K) .or. XYZ(L) .gt. TLIM(L,K+1))GOTO 12652
12651 CONTINUE
12652 CONTINUE
      IF(L .gt. LLIM)GOTO 12642
12641 CONTINUE
12642 CONTINUE
      IF(K .gt. KLIM)GOTO 12631
      ENDIF
      DO 12661 L=1,LLIM
      DLIM(L,1)=MIN(DLIM(L,1),XYZ(L))
      DLIM(L,2)=MAX(DLIM(L,2),XYZ(L))
12661 CONTINUE
12662 CONTINUE
12631 CONTINUE
12632 CONTINUE
      I2=I2+NINCR1*NINCR0
      I3=I3+NINCR1*NINCR0
12621 CONTINUE
12622 CONTINUE
      ELSEIF (IBTYPE.eq.1) THEN
      DO 12671 I=1,7
      XYZ(I)=0
12671 CONTINUE
12672 CONTINUE
      DO 12681 I=n1,nP
      IF (LTRAP) RETURN
      DO 12691 J=1,NINCR
      XYZ(IVARBL(J))=DATBUF(IM)
      IM=IM+1
12691 CONTINUE
12692 CONTINUE
      IF (KLIM .gt. 0) THEN
      DO 12701 K=1,KLIM,2
      DO 12711 L=1,LLIM
      T=XYZ(NCSIZE*(L-1)+N_XDATA)
      IF(T .lt. TLIM(L,K) .or. T .gt. TLIM(L,K+1))GOTO 12712
12711 CONTINUE
12712 CONTINUE
      IF(L .gt. LLIM)GOTO 12702
12701 CONTINUE
12702 CONTINUE
      IF(K .gt. KLIM)GOTO 12681
      ENDIF
      DO 12721 J=1,LLIM
      DLIM(J,1)=MIN(DLIM(J,1),XYZ(NCSIZE*(J-1)+N_XDATA))
      DLIM(J,2)=MAX(DLIM(J,2),XYZ(NCSIZE*(J-1)+N_XDATA))
12721 CONTINUE
12722 CONTINUE
12681 CONTINUE
12682 CONTINUE
      ENDIF
      ENDIF
12611 CONTINUE
12612 CONTINUE
      END
      SUBROUTINE T2DTSM(X,Y,DX,DY,DSUM,DERR,LWEIGHT)
      IMPLICIT NONE
      LOGICAL LWEIGHT
      INTEGER I,J
      REAL X,Y,DX,DY
      DOUBLE PRECISION DSUM(8),DXV,DDY2,DDX2,DTEMP1,DYV2,DYV,DERR(8,4)
      DSUM(8)=DSUM(8)+1.
      IF (Y.eq.0 .and. DY.eq.0 .and. DX.eq.0) RETURN
      DSUM(7)=DSUM(7)+1
      DXV=X
      DYV=Y
      DYV2=DYV**2
      DDX2=DX
      DDX2=DDX2**2
      DDY2=DY
      DTEMP1=1
      DO 12731 J=1,3
      DSUM(J)=DSUM(J)+DYV*DTEMP1
      DERR(J,2)=DERR(J,2)+DDX2*DTEMP1*DYV2
      DTEMP1=DTEMP1*DXV
12731 CONTINUE
12732 CONTINUE
      IF (DY .ne.0) THEN
      DTEMP1=1
      DDY2=DDY2**2
      DO 12741 J=1,5
      DERR(J,1)=DERR(J,1)+DDY2*DTEMP1
      DTEMP1=DTEMP1*DXV
12741 CONTINUE
12742 CONTINUE
      ENDIF
      END
      SUBROUTINE T2_SHOW_FILE(IFILE,NAME)
      IMPLICIT NONE
      INTEGER IFILE,I,J,JMAX,T2BTRIM
      CHARACTER *(*) NAME
      LOGICAL LOPEN
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      I=ABS(IFILE)
      IF (I.eq.0) RETURN
      INQUIRE(UNIT=I,NAME=OUTSTR,ERR=12750,OPENED=LOPEN,NEXTREC=J)
      IF (.NOT. LOPEN) RETURN
      J=J-1
      IF (J .le. 0) THEN
      J=0
      IF(I.le.20) J=NINP(I)
      ENDIF
      JMAX=T2BTRIM(OUTSTR)
      WRITE(6,*,ERR=12750)'   ',NAME,' Unit=',I,' Line=',J
      WRITE(6,*,ERR=12750)'     File=','"'//OUTSTR(:JMAX)//'"'
12750 CONTINUE
      END
      SUBROUTINE T2WRSQ(STR,LCOMP,LUN,IB)
      IMPLICIT NONE
      CHARACTER *(512) STR
      LOGICAL LCOMP,LALPHA
      INTEGER LUN,IB
      INTEGER I,IMOVE,IBEG,IEND,ISTR,T2BTRIM,ILAST 
      ISTR=512
12761 CONTINUE
      I=INDEX(STR(1:ISTR),'E+00 ')
      IF(I.gt.0) THEN
      STR(I:I+3)=' '
      ELSE
      GOTO 12762
      ENDIF
      GOTO 12761
12762 CONTINUE
      IF (LCOMP) THEN
      IMOVE=MAX(1,IB)
      IBEG=0
      IEND=0
      ILAST=1
      LALPHA=.true.
      DO 12771 I=MAX(1,IB),ISTR
      IF (STR(I:I).eq.' ') THEN
      IF (IBEG.GE.IMOVE) THEN
      IF (IBEG.ne.IMOVE) STR(IMOVE:I)=STR(IBEG:IEND)
      IMOVE=(IEND-IBEG)+IMOVE+2
      ILAST=IMOVE-2
      ENDIF
      IBEG=0
      IEND=0
      LALPHA=.true.
      ELSEIF (.not.LALPHA.and.STR(I:I).eq.'0') THEN
      IF (IBEG.eq.0) THEN
      IBEG=I
      IEND=I
      ENDIF
      ELSE
      IF (INDEX('0123456789',STR(I:I)).le.0) THEN
      IF (.not.LALPHA )THEN
      IF (IBEG.GE.IMOVE) THEN
      IF (IBEG.ne.IMOVE) STR(IMOVE:I-1)=STR(IBEG:IEND)
      IMOVE=(IEND-IBEG)+IMOVE+1
      ILAST=IMOVE-2
      ENDIF
      IBEG=I
      ENDIF
      LALPHA=.true.
      ENDIF
      IF (STR(I:I).eq.'.') LALPHA=.false.
      IF (IBEG.eq.0) IBEG=I
      IEND=I
      ENDIF
12771 CONTINUE
12772 CONTINUE
      I=MIN(I,ISTR)
      IF (IBEG.GE.IMOVE) THEN
      IF (IBEG.ne.IMOVE) STR(IMOVE:I)=STR(IBEG:IEND)
      IMOVE=(IEND-IBEG)+IMOVE+2
      ILAST=IMOVE-2
      IEND=0
      ENDIF
      ISTR=MAX(ILAST,IEND)
      ELSE
      ISTR=T2BTRIM(STR)
      ENDIF
      WRITE(LUN,'(A)') ' '//STR(1:ISTR)
      END
      SUBROUTINE T2_SHOW_CHARACTERS(INFOIN,CARDIN)
      IMPLICIT NONE
      INTEGER INFOIN(10),I,J,K,L
      CHARACTER*(*) CARDIN
      COMMON /T2FLGC/ FLAGS(200), LTRAP,LHANDL,LSYERR,LSCREV
      LOGICAL FLAGS, LTRAP,LHANDL,LSYERR,LSCREV(3)
      INTEGER RELFLAG 
      PARAMETER (RELFLAG=151)
      INTEGER IWINLEV 
      INTEGER NWINLEV , MAX_FILL 
      PARAMETER (NWINLEV =4)
      PARAMETER (MAX_FILL=4)
      REAL GRDSYM, GRDSIZ, DATDAT(2,8), H2STAT(12), TITLIN(4), TITFA
     *C(4), TITLOC(4), TITMAR(4), TITLMX(4), TIKFAC, TITINX, TITX1, TIT
     *Y1, TITX, TITY, TITZ, TITSIZ, TITCON(5), REVLEV, REDUCE(5), XFR
     *M12(12), XFRM13(12), XFRM14(12), XFRM23(12), XFRM24(12), XFRM34(6
     *), XVARSX(20), CIRSIZ(2,3), ASIZE, AFLARE, SMSZDF, ORAXES(3), EY
     *EDIR(3), VUEDIR(3), VUECEN(3), VERTCL(3), EYESEP, SCRD, SCRZ, EYE
     *DIS, EYEPNT(3), XYPART(2, 2), BARSIZ(3), BARBRK(3), TIKSIZ(3), XY
     *ZBAS(3), TTHETA, TPHI, FRELBL(4), PATRN(20,30), SCLPRM(10,3), WI
     *NDOW(4), SCREEN(2), SYMBOL, NOSYMB, FACTXY(19), LBLSIZ, SYMSIZ, X
     *YZLIM(3,2), WORLD(3), RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY
     *0, XUNUSD(6), AXANG(3), REDFAC, DSCAL, PATSZ, MARGIN(4), PSCR(2
     *), OREAL, OCPU, CSCRD, DATPTS, ERRPTS, DATXMN, DATXMX, DATYMN, DA
     *TYMX, DATZMN, DATZMX, DATSUM, ERRSUM, DATAVE, ERRAVE, DATCEN, ERR
     *CEN, DATSTD, ERRSTD, WINREL(2,2,NWINLEV),WINABS(2,2,NWINLEV),WINL
     *IM(2,2), FMARKER(3,8), SYDIR(3), GRDIR(3), EXYZLIM(3,2), DSLOPE(2
     *,2)
      REAL PLOT_EXTENT(2,2),FILL_ANGLE(MAX_FILL),FILL_WIDTH(MAX_FILL)
      INTEGER FILL_INDEX, FILL_TEX(MAX_FILL), N_LINES(6)
      EQUIVALENCE (DATDAT, DATPTS)
      INTEGER MAXREP
      PARAMETER (MAXREP=5)
      INTEGER IPATRN, NPATRN(30), NXYLIM(3,2), NPLOTS, NCSETS, NCCOL, N
     *CROW, IYEAR, IMONTH, IDAY, ISIGFG, ITXPRI, ITXSEC, ITITDT(3), L
     *ENCRD, IPROP, IHTEX, IBLINK, IERASE, ITCNTR, IUNUSD, NXYZ1(3), 
     *NXYZ2(3), LBLFMT(3), LBLCHR(3), NDIMNS(3), IBLKTP, IDIMNS, NMES
     *H0, NMESH1, NMESH2, MESH1, MESH2, MESH3, MESH2D, MESHN(3), NMESHN(
     *2), NFIELD, IFIELD(19), NINCR, NPOINT, IVARBL(19), IVPTR(19), I_
     *VORDER(19,2), LINEAR(4), NONLIN(4), MXECHO, LINES, MAXLNS, USRK
     *BD, USRSCR, PLTFIL, LINWID, LINCOL, LINTEX, ICPOIN(3), IREPCT(MA
     *XREP), LEVREP, GRDTYP, GRDTEX, OUTTEX, IAXTEX, TITEX, LETSET, LAB
     *TEX, TICTEX, SHADOWTYP,SHADOWTEX, NXYZDEF1(10), NXYZDEF2(10), IF
     *ILE_CASE ,MAX_SUBST
      INTEGER MAX_CYCLE
      PARAMETER (MAX_CYCLE=20)
      INTEGER N_CYCLE, ITX_CYCLE(MAX_CYCLE)
      REAL SYM_CYCLE(MAX_CYCLE)
      EQUIVALENCE (NMESH1,NMESHN)
      EQUIVALENCE (MESH1,MESHN)
      INTEGER IBUFFR(400)
      REAL BUFFER(400)
      INTEGER NCHSAVE 
      PARAMETER (NCHSAVE=2*512) 
      INTEGER*4 ICHSAVE(NCHSAVE)
      INTEGER*4 IVRPTR(15)
      CHARACTER*512 OUTSTR,C_FILE, C_NAME, C_SELECT
      CHARACTER C_TIT_ESCAPE*1,C_TIT_SUBSTITUTE*2
      INTEGER N_FILE, N_NAME, N_SELECT
      CHARACTER*8 PXNAME
      CHARACTER*64 INPFMT
      LOGICAL LTDATA, OUTSID(4)
      COMMON /T2COM/ PXNAME, REDUCE, TITX, TITY ,XFRM12, XFRM13, XFRM1
     *4, XFRM23 ,XFRM24, XFRM34 ,XVARSX ,TITSIZ, GRDSYM, GRDSIZ, CIRS
     *IZ, ASIZE, AFLARE ,SMSZDF, ORAXES, EYEDIR, VUEDIR, VUECEN ,VERTC
     *L, EYESEP, SCRD, SCRZ, EYEDIS, EYEPNT ,XYPART, BARSIZ, TIKSIZ, XY
     *ZBAS, TTHETA ,TPHI, FRELBL, IPATRN, NPATRN, PATRN ,SCLPRM, WINDO
     *W, SCREEN, SYMBOL, NOSYMB ,FACTXY, LBLSIZ, SYMSIZ, XYZLIM, WORLD 
     *,RADRMX, RADRMN, RADAMN, RADANG, RADX0, RADY0, XUNUSD ,USRKBD, U
     *SRSCR, PLTFIL ,ITITDT, LENCRD ,INPFMT, GRDTYP, LINWID, LINCOL, L
     *INTEX, TITCON, ITCNTR ,IUNUSD, NXYZ1, NXYZ2 ,LBLCHR, NDIMNS, IBL
     *KTP, IDIMNS ,NMESH1, NMESH2, MESH1, MESH2, MESH3, NFIELD ,IFIELD
     *, NINCR ,IVARBL, IVRPTR ,LINEAR, NONLIN ,NPOINT, LETSET ,MXECH
     *O, LINES, MAXLNS ,AXANG, MESH2D, REDFAC, GRDTEX, OUTTEX, IAXTEX, 
     *TITEX, DSCAL ,OUTSTR, IPROP, IHTEX, IBLINK, IERASE, LABTEX, TICTE
     *X, NXYLIM, PATSZ ,MARGIN, PSCR, ITXPRI, ITXSEC, OREAL, OCPU, CSCR
     *D, OUTSID ,TITLIN, TITINX, TITZ, TITX1, TITY1, LTDATA, NPLOTS, RE
     *VLEV ,LBLFMT, IYEAR, IMONTH, IDAY, ISIGFG ,DATPTS, ERRPTS, DATXM
     *N, DATXMX, DATYMN, DATYMX, DATZMN, DATZMX ,DATSUM, ERRSUM, DATAVE
     *, ERRAVE, DATCEN, ERRCEN, DATSTD, ERRSTD ,NCSETS, NCCOL, NCROW, F
     *MARKER, H2STAT, TITFAC, TITLOC, TITMAR ,TIKFAC, IWINLEV, WINREL, 
     *WINABS, WINLIM ,ICPOIN, LEVREP, IREPCT, SYDIR, GRDIR, NMESH0, EXY
     *ZLIM, IVPTR ,TITLMX, NXYZDEF1, NXYZDEF2, IFILE_CASE, N_CYCLE, ITX
     *_CYCLE ,SYM_CYCLE, PLOT_EXTENT, FILL_ANGLE, FILL_WIDTH, FILL_TEX 
     *,FILL_INDEX ,N_LINES ,DSLOPE ,MAX_SUBST, BARBRK ,I_VORDER,SHADOW
     *TYP,SHADOWTEX
      COMMON /T2SCRT/ BUFFER, IBUFFR, N_FILE,N_NAME,N_SELECT, ICHSAVE
      COMMON /T2_CHAR/ C_TIT_ESCAPE,C_TIT_SUBSTITUTE
      COMMON /T2_SCRT/ C_FILE, C_NAME, C_SELECT
      INTEGER JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL, NINMAX
      PARAMETER (NINMAX=20)
      INTEGER NINP(NINMAX)
      COMMON /T2TRBK/NINP, JOUFIL, ERRFIL, OUTFIL, DBGFIL, INPFIL
      CHARACTER*512 STRNG, STJOU
      LOGICAL LTOKEN
      REAL FLOTNG
      INTEGER INTERP, KEYORD, NSTRNG, MAXSTR, NSTJOU, LSTJOU, NTOKEN
      INTEGER*4 INTEG
      COMMON /TOKENC/ INTERP, INTEG, FLOTNG, KEYORD, NSTRNG, MAXSTR, ST
     *RNG, NSTJOU, LSTJOU, STJOU, LTOKEN, NTOKEN
      BYTE TYPTAB(256),TYPTB2(256)
      CHARACTER*256 UPCHAR,OKCHAR,DNCHAR
      INTEGER INFOTOKK(3),IINDEX(3)
      COMMON /T2TOKNC/ TYPTAB,TYPTB2,INFOTOKK,IINDEX
      COMMON /T2UPCH/ UPCHAR,OKCHAR,DNCHAR
      CHARACTER*13 TYPES(6)
      CHARACTER*1 CCHAR
      INTEGER ITYPES(6)
      DATA ITYPES/5,8,7,10,11,12/
      DATA TYPES/  '  ALPHA=','  TERMINATOR=','  SEPARATOR=', '  COMMENT
     *=','  ENDCOMMENT=','  SPECIAL='/
      WRITE(6,12780)'Characters -'
      DO 12791 J=1,6
      OUTSTR='"'
      L=1
      DO 12801 I=1,256
      IF(TYPTAB(I).ne.ITYPES(J))GOTO 12801
      CCHAR=CHAR(I-1)
      CALL T2UPCS(CCHAR)
      IF(INDEX('\t ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-+.',CCHAR)
     *.gt.0) GOTO 12801
      L=L+1
      OUTSTR(L:L)=CCHAR
      IF(L+1 .ge. LEN(OUTSTR))GOTO 12802
12801 CONTINUE
12802 CONTINUE
      IF(LTRAP)GOTO 12792
      L=L+1
      OUTSTR(L:L)='"'
      IF (L.gt.2) WRITE(6,12810) TYPES(J),OUTSTR(1:L)
12791 CONTINUE
12792 CONTINUE
12780 FORMAT(2X,A)
12810 FORMAT(2X,A,T19,A)
      END
      SUBROUTINE T2_SET_DEFAULT_FILE(C_FILE,N_FILE,C_DEFAULT)
      IMPLICIT NONE
      CHARACTER*(*) C_FILE,C_DEFAULT
      CHARACTER*512 C_STRING
      INTEGER T2_GET_LOGICAL,ISTAT
      INTEGER N_STRING
      INTEGER N_FILE,I,J,K,L,IMIN,IMAX
      IF (N_FILE .ge. LEN(C_FILE)) RETURN
      IF (N_FILE .le. 0) THEN
      C_FILE=C_DEFAULT
      N_FILE=LEN(C_DEFAULT)
      RETURN
      ENDIF
      ISTAT=T2_GET_LOGICAL(C_FILE(:N_FILE),C_STRING,N_STRING)
      IF (N_STRING.gt.0) THEN
      C_FILE=C_STRING(:N_STRING)
      N_FILE=N_STRING
      ENDIF
      K=INDEX(C_DEFAULT,'.')-1
      imin=1
      L=0
      DO 12841 I=1,N_FILE
      IF ( C_FILE(I:I) .eq. '/') imin=I+1
12841 CONTINUE
12842 CONTINUE
      IF (C_FILE(N_FILE:N_FILE) .eq. '.') THEN
      N_FILE=MAX(1,N_FILE-1)
      ENDIF
      IF (imin.gt.N_FILE) THEN
      C_FILE(imin:)=C_DEFAULT
      N_FILE=N_FILE+LEN(C_DEFAULT)
      ELSEIF (K.gt.1) THEN
      I=INDEX(C_FILE(imin:N_FILE),'.')
      IF (I .eq. 1) THEN
      C_FILE(imin:)=C_DEFAULT(:k)//C_FILE(imin:N_FILE)
      N_FILE=N_FILE+k
      ELSEIF (I .eq. 0) THEN
      IF (L. gt .imin) THEN
      C_FILE(imin:)=C_FILE(imin:L-1)//C_DEFAULT(K+1:)//C_FILE(L:)
      ELSEIF (L .eq. imin) THEN
      C_FILE(imin:)=C_DEFAULT//C_FILE(L:)
      k=0
      ELSE
      C_FILE(imin:)=C_FILE(imin:N_FILE)//C_DEFAULT(K+1:)
      ENDIF
      N_FILE=N_FILE+(LEN(C_DEFAULT)-(k))
      ENDIF
      ENDIF
      N_FILE=MIN(N_FILE,LEN(C_FILE))
      END
      CHARACTER*4 FUNCTION T2_GET_SYMBOL(SYM)
      CHARACTER*4 C_SYM
      REAL SYM
      IF (SYM .lt. 0.5) THEN
      C_SYM='NONE'
      ELSE
      C_SYM='"  "'
      CALL SYMTXT(SYM,C_SYM(2:3))
      IF (C_SYM(2:3).eq.' ') C_SYM='DOT'
      ENDIF
      T2_GET_SYMBOL=C_SYM
      END
      CHARACTER*20 FUNCTION T2_GET_UNIT_NAME(UNIT)
      IMPLICIT NONE
      REAL UNIT,TEMP
      CHARACTER*20 CUNIT
      INTEGER J
      INTEGER NUNIT
      REAL INCHES , CM 
      CHARACTER*6 CUNIT3 
      PARAMETER (INCHES = 1.0)
      PARAMETER (CM = 2.54)
      PARAMETER (CUNIT3 = 'inches')
      REAL MM, DM, METERS, MILS, POINTS, FEET, YARDS 
      REAL FATHOMS, RODS, FURLONGS, MILES, LEAGUES 
      INTEGER MAXUNITS 
      PARAMETER ( MM = CM*10)
      PARAMETER ( DM = CM/10)
      PARAMETER ( METERS = CM/100)
      PARAMETER ( MILS = INCHES*1000)
      PARAMETER ( POINTS = INCHES*72)
      PARAMETER ( FEET = INCHES/12)
      PARAMETER ( YARDS = FEET/3)
      PARAMETER ( FATHOMS = FEET/6)
      PARAMETER ( RODS = FEET/16.5)
      PARAMETER ( FURLONGS = RODS/40)
      PARAMETER ( MILES = FURLONGS/8)
      PARAMETER ( LEAGUES = MILES/3)
      PARAMETER ( MAXUNITS = 14)
      REAL UNITS(MAXUNITS)
      CHARACTER*10 C_UNITS(MAXUNITS)
      DATA CUNIT/'?'/
      DATA UNITS/INCHES,MM,CM,METERS,POINTS,MILS,DM, FEET,YARDS,
     *FATHOMS,RODS,FURLONGS,MILES,LEAGUES/
      DATA C_UNITS/'inches','mm','cm','meters','points',
     *'mils','dm', 'feet','yards','fathoms','rods','furlongs',
     *'miles','leagues'/
      TEMP = 1. 
      IF (UNIT .GT. .000001 ) TEMP=UNIT 
      WRITE(CUNIT,'(A,1P,G10.2,5A)')  '(',1/TEMP,' inches)'
      CALL T2SQEZ(CUNIT,NUNIT)
      DO 12851 J=1,MAXUNITS
      IF (ABS(UNIT-UNITS(j)) .le. .001*unit) CUNIT=C_UNITS(J)
12851 CONTINUE
12852 CONTINUE
      T2_GET_UNIT_NAME=CUNIT
      END
